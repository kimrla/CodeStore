function dnL=nurlbasis(x, knots, order, der)

% Get non-uniform Langrane basis
% 
%   input :  x - the evalued point
%               knots - knot vector of each basis
%               order - the order of the Langrange basis
%               der - the order of derivatives
% 
%  output : dnL - a matrix includes the nurls basis or 
%                         their derivatives
%

if nargin==3
    der=0;
end

switch order
    case 1
        x1=knots(1); x2=knots(2);
        switch der 
            case 0
                dnL=[  (x - x2)/(x1 - x2)
                          -(x - x1)/(x1 - x2)];
            case 1
                dnL1=[  1/(x1 - x2)
                          -1/(x1 - x2)];
                 n=2; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(2,length(x));
        end
    case 2
        x1=knots(1); x2=knots(2); x3=knots(3); 
        switch der
            case 0
                dnL=[  ((x - x2).*(x - x3))/((x1 - x2).*(x1 - x3))
                          -((x - x1).*(x - x3))/((x1 - x2).*(x2 - x3))
                           ((x - x1).*(x - x2))/((x1 - x3).*(x2 - x3))];
            case 1
                dnL=[  -(x2 - 2.*x + x3)/((x1 - x2).*(x1 - x3))
                             (x1 - 2.*x + x3)/((x1 - x2).*(x2 - x3))
                            -(x1 - 2.*x + x2)/((x1 - x3).*(x2 - x3))];
            case 2
                dnL1=[  2/((x1 - x2).*(x1 - x3))
                          -2/((x1 - x2).*(x2 - x3))
                           2/((x1 - x3).*(x2 - x3))];
                n=3; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(3,length(x));
        end
    case 3
        x1=knots(1); x2=knots(2); x3=knots(3); x4=knots(4);
        switch der
            case 0
                dnL=[  ((x - x2).*(x - x3).*(x - x4))/((x1 - x2).*(x1 - x3).*(x1 - x4))
                          -((x - x1).*(x - x3).*(x - x4))/((x1 - x2).*(x2 - x3).*(x2 - x4))
                            ((x - x1).*(x - x2).*(x - x4))/((x1 - x3).*(x2 - x3).*(x3 - x4))
                           -((x - x1).*(x - x2).*(x - x3))/((x1 - x4).*(x2 - x4).*(x3 - x4))];
            case 1
                dnL=[  (x2.*x3 - 2.*x.*x3 - 2.*x.*x4 - 2.*x.*x2 + x2.*x4 + x3.*x4 + 3.*x.^2)/((x1 - x2).*(x1 - x3).*(x1 - x4))
                          -(x1.*x3 - 2.*x.*x3 - 2.*x.*x4 - 2.*x.*x1 + x1.*x4 + x3.*x4 + 3.*x.^2)/((x1 - x2).*(x2 - x3).*(x2 - x4))
                            (x1.*x2 - 2.*x.*x2 - 2.*x.*x1 - 2.*x.*x4 + x1.*x4 + x2.*x4 + 3.*x.^2)/((x1 - x3).*(x2 - x3).*(x3 - x4))
                           -(x1.*x2 - 2.*x.*x2 - 2.*x.*x3 - 2.*x.*x1 + x1.*x3 + x2.*x3 + 3.*x.^2)/((x1 - x4).*(x2 - x4).*(x3 - x4))];
            case 2
                dnL=[ -(2.*x2 - 6.*x + 2.*x3 + 2.*x4)/((x1 - x2).*(x1 - x3).*(x1 - x4))
                            (2.*x1 - 6.*x + 2.*x3 + 2.*x4)/((x1 - x2).*(x2 - x3).*(x2 - x4))
                           -(2.*x1 - 6.*x + 2.*x2 + 2.*x4)/((x1 - x3).*(x2 - x3).*(x3 - x4))
                            (2.*x1 - 6.*x + 2.*x2 + 2.*x3)/((x1 - x4).*(x2 - x4).*(x3 - x4))];
            case 3
                dnL1=[  6/((x1 - x2).*(x1 - x3).*(x1 - x4))
                          -6/((x1 - x2).*(x2 - x3).*(x2 - x4))
                            6/((x1 - x3).*(x2 - x3).*(x3 - x4))
                           -6/((x1 - x4).*(x2 - x4).*(x3 - x4))];
                 n=4; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(4,length(x));
        end
    case 4
        x1=knots(1); x2=knots(2); x3=knots(3); x4=knots(4); x5=knots(5); 
        switch der
            case 0
                dnL=[  ((x - x2).*(x - x3).*(x - x4).*(x - x5))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5))
                          -((x - x1).*(x - x3).*(x - x4).*(x - x5))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5))
                           ((x - x1).*(x - x2).*(x - x4).*(x - x5))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5))
                          -((x - x1).*(x - x2).*(x - x3).*(x - x5))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5))
                           ((x - x1).*(x - x2).*(x - x3).*(x - x4))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5)) ];
            case 1
                dnL=[ -(3.*x.^2.*x2 + 3.*x.^2.*x3 + 3.*x.^2.*x4 + 3.*x.^2.*x5 - 4.*x.^3 - 2.*x.*x2.*x3 - 2.*x.*x2.*x4 - 2.*x.*x2.*x5 - 2.*x.*x3.*x4 - 2.*x.*x3.*x5 - 2.*x.*x4.*x5 + x2.*x3.*x4 + x2.*x3.*x5 + x2.*x4.*x5 + x3.*x4.*x5)/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5))
                            (3.*x.^2.*x1 + 3.*x.^2.*x3 + 3.*x.^2.*x4 + 3.*x.^2.*x5 - 4.*x.^3 - 2.*x.*x1.*x3 - 2.*x.*x1.*x4 - 2.*x.*x1.*x5 - 2.*x.*x3.*x4 - 2.*x.*x3.*x5 + x1.*x3.*x4 - 2.*x.*x4.*x5 + x1.*x3.*x5 + x1.*x4.*x5 + x3.*x4.*x5)/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5))
                           -(3.*x.^2.*x1 + 3.*x.^2.*x2 + 3.*x.^2.*x4 + 3.*x.^2.*x5 - 4.*x.^3 - 2.*x.*x1.*x2 - 2.*x.*x1.*x4 - 2.*x.*x1.*x5 - 2.*x.*x2.*x4 - 2.*x.*x2.*x5 + x1.*x2.*x4 + x1.*x2.*x5 - 2.*x.*x4.*x5 + x1.*x4.*x5 + x2.*x4.*x5)/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5))
                            (3.*x.^2.*x1 + 3.*x.^2.*x2 + 3.*x.^2.*x3 + 3.*x.^2.*x5 - 4.*x.^3 - 2.*x.*x1.*x2 - 2.*x.*x1.*x3 - 2.*x.*x2.*x3 - 2.*x.*x1.*x5 + x1.*x2.*x3 - 2.*x.*x2.*x5 - 2.*x.*x3.*x5 + x1.*x2.*x5 + x1.*x3.*x5 + x2.*x3.*x5)/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5))
                           -(3.*x.^2.*x1 + 3.*x.^2.*x2 + 3.*x.^2.*x3 + 3.*x.^2.*x4 - 4.*x.^3 - 2.*x.*x1.*x2 - 2.*x.*x1.*x3 - 2.*x.*x1.*x4 - 2.*x.*x2.*x3 - 2.*x.*x2.*x4 + x1.*x2.*x3 - 2.*x.*x3.*x4 + x1.*x2.*x4 + x1.*x3.*x4 + x2.*x3.*x4)/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5)) ];
            case 2
                dnL=[(2.*x2.*x3 - 6.*x.*x3 - 6.*x.*x4 - 6.*x.*x5 - 6.*x.*x2 + 2.*x2.*x4 + 2.*x2.*x5 + 2.*x3.*x4 + 2.*x3.*x5 + 2.*x4.*x5 + 12.*x.^2)/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5))
                        -(2.*x1.*x3 - 6.*x.*x3 - 6.*x.*x4 - 6.*x.*x1 - 6.*x.*x5 + 2.*x1.*x4 + 2.*x1.*x5 + 2.*x3.*x4 + 2.*x3.*x5 + 2.*x4.*x5 + 12.*x.^2)/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5))
                          (2.*x1.*x2 - 6.*x.*x2 - 6.*x.*x1 - 6.*x.*x4 - 6.*x.*x5 + 2.*x1.*x4 + 2.*x1.*x5 + 2.*x2.*x4 + 2.*x2.*x5 + 2.*x4.*x5 + 12.*x.^2)/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5))
                         -(2.*x1.*x2 - 6.*x.*x2 - 6.*x.*x3 - 6.*x.*x1 + 2.*x1.*x3 - 6.*x.*x5 + 2.*x2.*x3 + 2.*x1.*x5 + 2.*x2.*x5 + 2.*x3.*x5 + 12.*x.^2)/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5))
                          (2.*x1.*x2 - 6.*x.*x2 - 6.*x.*x3 - 6.*x.*x1 - 6.*x.*x4 + 2.*x1.*x3 + 2.*x1.*x4 + 2.*x2.*x3 + 2.*x2.*x4 + 2.*x3.*x4 + 12.*x.^2)/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5)) ];
            case 3
                dnL = [ -(6.*x2 - 24.*x + 6.*x3 + 6.*x4 + 6.*x5)/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5))
                              (6.*x1 - 24.*x + 6.*x3 + 6.*x4 + 6.*x5)/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5))
                            -(6.*x1 - 24.*x + 6.*x2 + 6.*x4 + 6.*x5)/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5))
                              (6.*x1 - 24.*x + 6.*x2 + 6.*x3 + 6.*x5)/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5))
                            -(6.*x1 - 24.*x + 6.*x2 + 6.*x3 + 6.*x4)/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5)) ];
            case 4
                dnL1=[  24/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5))
                          -24/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5))
                            24/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5))
                          -24/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5))
                            24/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5))];
                 n=5; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(5,length(x));
        end
    case 5
        x1=knots(1); x2=knots(2); x3=knots(3); x4=knots(4); x5=knots(5); x6=knots(6); 
        switch der
            case 0
                  dnL=[  ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6))
                              -((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6))
                                ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6))
                               -((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6))
                                ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6))
                               -((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6))];
            case 1
                dnL = [    ((x - x2).*(x - x3).*(x - x4).*(x - x5))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6)) + ((x - x2).*(x - x3).*(x - x4).*(x - x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6)) + ((x - x2).*(x - x3).*(x - x5).*(x - x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6)) + ((x - x2).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6)) + ((x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6))
                               - ((x - x1).*(x - x3).*(x - x4).*(x - x5))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6)) - ((x - x1).*(x - x3).*(x - x4).*(x - x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6)) - ((x - x1).*(x - x3).*(x - x5).*(x - x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6)) - ((x - x1).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6)) - ((x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6))
                                 ((x - x1).*(x - x2).*(x - x4).*(x - x5))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6)) + ((x - x1).*(x - x2).*(x - x4).*(x - x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6)) + ((x - x1).*(x - x2).*(x - x5).*(x - x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6)) + ((x - x1).*(x - x4).*(x - x5).*(x - x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6)) + ((x - x2).*(x - x4).*(x - x5).*(x - x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6))
                               - ((x - x1).*(x - x2).*(x - x3).*(x - x5))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6)) - ((x - x1).*(x - x2).*(x - x3).*(x - x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6)) - ((x - x1).*(x - x2).*(x - x5).*(x - x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6)) - ((x - x1).*(x - x3).*(x - x5).*(x - x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6)) - ((x - x2).*(x - x3).*(x - x5).*(x - x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6))
                                 ((x - x1).*(x - x2).*(x - x3).*(x - x4))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6)) + ((x - x1).*(x - x2).*(x - x3).*(x - x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6)) + ((x - x1).*(x - x2).*(x - x4).*(x - x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6)) + ((x - x1).*(x - x3).*(x - x4).*(x - x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6)) + ((x - x2).*(x - x3).*(x - x4).*(x - x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6))
                               - ((x - x1).*(x - x2).*(x - x3).*(x - x4))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) - ((x - x1).*(x - x2).*(x - x4).*(x - x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) - ((x - x2).*(x - x3).*(x - x4).*(x - x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) ];
            case 2
                dnL = [ -(2.*(6.*x.^2.*x2 + 6.*x.^2.*x3 + 6.*x.^2.*x4 + 6.*x.^2.*x5 + 6.*x.^2.*x6 - 10.*x.^3 - 3.*x.*x2.*x3 - 3.*x.*x2.*x4 - 3.*x.*x2.*x5 - 3.*x.*x3.*x4 - 3.*x.*x2.*x6 - 3.*x.*x3.*x5 - 3.*x.*x3.*x6 - 3.*x.*x4.*x5 + x2.*x3.*x4 - 3.*x.*x4.*x6 + x2.*x3.*x5 - 3.*x.*x5.*x6 + x2.*x3.*x6 + x2.*x4.*x5 + x2.*x4.*x6 + x3.*x4.*x5 + x2.*x5.*x6 + x3.*x4.*x6 + x3.*x5.*x6 + x4.*x5.*x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6))
                             (2.*(6.*x.^2.*x1 + 6.*x.^2.*x3 + 6.*x.^2.*x4 + 6.*x.^2.*x5 + 6.*x.^2.*x6 - 10.*x.^3 - 3.*x.*x1.*x3 - 3.*x.*x1.*x4 - 3.*x.*x1.*x5 - 3.*x.*x1.*x6 - 3.*x.*x3.*x4 - 3.*x.*x3.*x5 + x1.*x3.*x4 - 3.*x.*x3.*x6 - 3.*x.*x4.*x5 + x1.*x3.*x5 - 3.*x.*x4.*x6 + x1.*x3.*x6 + x1.*x4.*x5 - 3.*x.*x5.*x6 + x1.*x4.*x6 + x1.*x5.*x6 + x3.*x4.*x5 + x3.*x4.*x6 + x3.*x5.*x6 + x4.*x5.*x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6))
                              -(2.*(6.*x.^2.*x1 + 6.*x.^2.*x2 + 6.*x.^2.*x4 + 6.*x.^2.*x5 + 6.*x.^2.*x6 - 10.*x.^3 - 3.*x.*x1.*x2 - 3.*x.*x1.*x4 - 3.*x.*x1.*x5 - 3.*x.*x2.*x4 - 3.*x.*x1.*x6 - 3.*x.*x2.*x5 + x1.*x2.*x4 - 3.*x.*x2.*x6 + x1.*x2.*x5 - 3.*x.*x4.*x5 + x1.*x2.*x6 - 3.*x.*x4.*x6 + x1.*x4.*x5 - 3.*x.*x5.*x6 + x1.*x4.*x6 + x2.*x4.*x5 + x1.*x5.*x6 + x2.*x4.*x6 + x2.*x5.*x6 + x4.*x5.*x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6))
                               (2.*(6.*x.^2.*x1 + 6.*x.^2.*x2 + 6.*x.^2.*x3 + 6.*x.^2.*x5 + 6.*x.^2.*x6 - 10.*x.^3 - 3.*x.*x1.*x2 - 3.*x.*x1.*x3 - 3.*x.*x2.*x3 - 3.*x.*x1.*x5 + x1.*x2.*x3 - 3.*x.*x1.*x6 - 3.*x.*x2.*x5 - 3.*x.*x2.*x6 - 3.*x.*x3.*x5 + x1.*x2.*x5 - 3.*x.*x3.*x6 + x1.*x2.*x6 + x1.*x3.*x5 + x1.*x3.*x6 + x2.*x3.*x5 - 3.*x.*x5.*x6 + x2.*x3.*x6 + x1.*x5.*x6 + x2.*x5.*x6 + x3.*x5.*x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6))
                              -(2.*(6.*x.^2.*x1 + 6.*x.^2.*x2 + 6.*x.^2.*x3 + 6.*x.^2.*x4 + 6.*x.^2.*x6 - 10.*x.^3 - 3.*x.*x1.*x2 - 3.*x.*x1.*x3 - 3.*x.*x1.*x4 - 3.*x.*x2.*x3 - 3.*x.*x2.*x4 + x1.*x2.*x3 - 3.*x.*x1.*x6 - 3.*x.*x3.*x4 + x1.*x2.*x4 - 3.*x.*x2.*x6 + x1.*x3.*x4 - 3.*x.*x3.*x6 + x1.*x2.*x6 + x2.*x3.*x4 - 3.*x.*x4.*x6 + x1.*x3.*x6 + x1.*x4.*x6 + x2.*x3.*x6 + x2.*x4.*x6 + x3.*x4.*x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6))
                               (2.*(6.*x.^2.*x1 + 6.*x.^2.*x2 + 6.*x.^2.*x3 + 6.*x.^2.*x4 + 6.*x.^2.*x5 - 10.*x.^3 - 3.*x.*x1.*x2 - 3.*x.*x1.*x3 - 3.*x.*x1.*x4 - 3.*x.*x2.*x3 - 3.*x.*x1.*x5 - 3.*x.*x2.*x4 + x1.*x2.*x3 - 3.*x.*x2.*x5 - 3.*x.*x3.*x4 + x1.*x2.*x4 - 3.*x.*x3.*x5 + x1.*x2.*x5 + x1.*x3.*x4 - 3.*x.*x4.*x5 + x1.*x3.*x5 + x2.*x3.*x4 + x1.*x4.*x5 + x2.*x3.*x5 + x2.*x4.*x5 + x3.*x4.*x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6))];
            case 3
                dnL = [  (2.*(3.*x2.*x3 - 12.*x.*x3 - 12.*x.*x4 - 12.*x.*x5 - 12.*x.*x2 - 12.*x.*x6 + 3.*x2.*x4 + 3.*x2.*x5 + 3.*x3.*x4 + 3.*x2.*x6 + 3.*x3.*x5 + 3.*x3.*x6 + 3.*x4.*x5 + 3.*x4.*x6 + 3.*x5.*x6 + 30.*x.^2))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6))
                               -(2.*(3.*x1.*x3 - 12.*x.*x3 - 12.*x.*x4 - 12.*x.*x1 - 12.*x.*x5 + 3.*x1.*x4 - 12.*x.*x6 + 3.*x1.*x5 + 3.*x1.*x6 + 3.*x3.*x4 + 3.*x3.*x5 + 3.*x3.*x6 + 3.*x4.*x5 + 3.*x4.*x6 + 3.*x5.*x6 + 30.*x.^2))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6))
                                (2.*(3.*x1.*x2 - 12.*x.*x2 - 12.*x.*x1 - 12.*x.*x4 - 12.*x.*x5 + 3.*x1.*x4 - 12.*x.*x6 + 3.*x1.*x5 + 3.*x2.*x4 + 3.*x1.*x6 + 3.*x2.*x5 + 3.*x2.*x6 + 3.*x4.*x5 + 3.*x4.*x6 + 3.*x5.*x6 + 30.*x.^2))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6))
                               -(2.*(3.*x1.*x2 - 12.*x.*x2 - 12.*x.*x3 - 12.*x.*x1 + 3.*x1.*x3 - 12.*x.*x5 + 3.*x2.*x3 - 12.*x.*x6 + 3.*x1.*x5 + 3.*x1.*x6 + 3.*x2.*x5 + 3.*x2.*x6 + 3.*x3.*x5 + 3.*x3.*x6 + 3.*x5.*x6 + 30.*x.^2))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6))
                                (2.*(3.*x1.*x2 - 12.*x.*x2 - 12.*x.*x3 - 12.*x.*x1 - 12.*x.*x4 + 3.*x1.*x3 + 3.*x1.*x4 + 3.*x2.*x3 - 12.*x.*x6 + 3.*x2.*x4 + 3.*x1.*x6 + 3.*x3.*x4 + 3.*x2.*x6 + 3.*x3.*x6 + 3.*x4.*x6 + 30.*x.^2))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6))
                               -(2.*(3.*x1.*x2 - 12.*x.*x2 - 12.*x.*x3 - 12.*x.*x1 - 12.*x.*x4 + 3.*x1.*x3 - 12.*x.*x5 + 3.*x1.*x4 + 3.*x2.*x3 + 3.*x1.*x5 + 3.*x2.*x4 + 3.*x2.*x5 + 3.*x3.*x4 + 3.*x3.*x5 + 3.*x4.*x5 + 30.*x.^2))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) ];
            case 4
                dnL = [ -(2.*(12.*x2 - 60.*x + 12.*x3 + 12.*x4 + 12.*x5 + 12.*x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6))
                               (2.*(12.*x1 - 60.*x + 12.*x3 + 12.*x4 + 12.*x5 + 12.*x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6))
                              -(2.*(12.*x1 - 60.*x + 12.*x2 + 12.*x4 + 12.*x5 + 12.*x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6))
                               (2.*(12.*x1 - 60.*x + 12.*x2 + 12.*x3 + 12.*x5 + 12.*x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6))
                              -(2.*(12.*x1 - 60.*x + 12.*x2 + 12.*x3 + 12.*x4 + 12.*x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6))
                               (2.*(12.*x1 - 60.*x + 12.*x2 + 12.*x3 + 12.*x4 + 12.*x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) ];
            case 5
                dnL1 = [  120/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6))
                              -120/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6))
                               120/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6))
                              -120/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6))
                               120/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6))
                              -120/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6)) ];
                n=6; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(6,length(x));
        end
    case 6
        x1=knots(1); x2=knots(2); x3=knots(3); x4=knots(4); x5=knots(5); x6=knots(6); x7=knots(7); 
        switch der
            case 0
                dnL=[((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                        -((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                         ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                        -((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                          ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                         -((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                           ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) ];
            case 1
                dnL=[ ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7)) + ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7)) + ((x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7)) + ((x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7)) + ((x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7)) + ((x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                        - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7)) - ((x - x1).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7)) - ((x - x1).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7)) - ((x - x1).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7)) - ((x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                           ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7)) + ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7)) + ((x - x1).*(x - x2).*(x - x4).*(x - x6).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7)) + ((x - x1).*(x - x2).*(x - x5).*(x - x6).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7)) + ((x - x1).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7)) + ((x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                         - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7)) - ((x - x1).*(x - x2).*(x - x3).*(x - x6).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7)) - ((x - x1).*(x - x2).*(x - x5).*(x - x6).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7)) - ((x - x1).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7)) - ((x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                           ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7)) + ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7)) + ((x - x1).*(x - x2).*(x - x3).*(x - x6).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7)) + ((x - x1).*(x - x2).*(x - x4).*(x - x6).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7)) + ((x - x1).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7)) + ((x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                         - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7)) - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7)) - ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7)) - ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                           ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) + ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) + ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) + ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) + ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) + ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) ];
            case 2
                dnL=[(2.*(15.*x.^4 - 10.*x.^3.*x3 - 10.*x.^3.*x4 - 10.*x.^3.*x5 - 10.*x.^3.*x6 - 10.*x.^3.*x7 - 10.*x.^3.*x2 + 6.*x.^2.*x2.*x3 + 6.*x.^2.*x2.*x4 + 6.*x.^2.*x2.*x5 + 6.*x.^2.*x3.*x4 + 6.*x.^2.*x2.*x6 + 6.*x.^2.*x3.*x5 + 6.*x.^2.*x2.*x7 + 6.*x.^2.*x3.*x6 + 6.*x.^2.*x4.*x5 + 6.*x.^2.*x3.*x7 + 6.*x.^2.*x4.*x6 + 6.*x.^2.*x4.*x7 + 6.*x.^2.*x5.*x6 + 6.*x.^2.*x5.*x7 + 6.*x.^2.*x6.*x7 - 3.*x.*x2.*x3.*x4 - 3.*x.*x2.*x3.*x5 - 3.*x.*x2.*x3.*x6 - 3.*x.*x2.*x4.*x5 - 3.*x.*x2.*x3.*x7 - 3.*x.*x2.*x4.*x6 - 3.*x.*x3.*x4.*x5 - 3.*x.*x2.*x4.*x7 - 3.*x.*x2.*x5.*x6 - 3.*x.*x3.*x4.*x6 - 3.*x.*x2.*x5.*x7 - 3.*x.*x3.*x4.*x7 - 3.*x.*x3.*x5.*x6 + x2.*x3.*x4.*x5 - 3.*x.*x2.*x6.*x7 - 3.*x.*x3.*x5.*x7 - 3.*x.*x4.*x5.*x6 + x2.*x3.*x4.*x6 - 3.*x.*x3.*x6.*x7 - 3.*x.*x4.*x5.*x7 + x2.*x3.*x4.*x7 + x2.*x3.*x5.*x6 - 3.*x.*x4.*x6.*x7 + x2.*x3.*x5.*x7 + x2.*x4.*x5.*x6 - 3.*x.*x5.*x6.*x7 + x2.*x3.*x6.*x7 + x2.*x4.*x5.*x7 + x3.*x4.*x5.*x6 + x2.*x4.*x6.*x7 + x3.*x4.*x5.*x7 + x2.*x5.*x6.*x7 + x3.*x4.*x6.*x7 + x3.*x5.*x6.*x7 + x4.*x5.*x6.*x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                        -(2.*(15.*x.^4 - 10.*x.^3.*x3 - 10.*x.^3.*x4 - 10.*x.^3.*x5 - 10.*x.^3.*x6 - 10.*x.^3.*x7 - 10.*x.^3.*x1 + 6.*x.^2.*x1.*x3 + 6.*x.^2.*x1.*x4 + 6.*x.^2.*x1.*x5 + 6.*x.^2.*x1.*x6 + 6.*x.^2.*x3.*x4 + 6.*x.^2.*x1.*x7 + 6.*x.^2.*x3.*x5 + 6.*x.^2.*x3.*x6 + 6.*x.^2.*x4.*x5 + 6.*x.^2.*x3.*x7 + 6.*x.^2.*x4.*x6 + 6.*x.^2.*x4.*x7 + 6.*x.^2.*x5.*x6 + 6.*x.^2.*x5.*x7 + 6.*x.^2.*x6.*x7 - 3.*x.*x1.*x3.*x4 - 3.*x.*x1.*x3.*x5 - 3.*x.*x1.*x3.*x6 - 3.*x.*x1.*x4.*x5 - 3.*x.*x1.*x3.*x7 - 3.*x.*x1.*x4.*x6 - 3.*x.*x1.*x4.*x7 - 3.*x.*x1.*x5.*x6 - 3.*x.*x3.*x4.*x5 - 3.*x.*x1.*x5.*x7 - 3.*x.*x3.*x4.*x6 + x1.*x3.*x4.*x5 - 3.*x.*x1.*x6.*x7 - 3.*x.*x3.*x4.*x7 - 3.*x.*x3.*x5.*x6 + x1.*x3.*x4.*x6 - 3.*x.*x3.*x5.*x7 - 3.*x.*x4.*x5.*x6 + x1.*x3.*x4.*x7 + x1.*x3.*x5.*x6 - 3.*x.*x3.*x6.*x7 - 3.*x.*x4.*x5.*x7 + x1.*x3.*x5.*x7 + x1.*x4.*x5.*x6 - 3.*x.*x4.*x6.*x7 + x1.*x3.*x6.*x7 + x1.*x4.*x5.*x7 - 3.*x.*x5.*x6.*x7 + x1.*x4.*x6.*x7 + x3.*x4.*x5.*x6 + x1.*x5.*x6.*x7 + x3.*x4.*x5.*x7 + x3.*x4.*x6.*x7 + x3.*x5.*x6.*x7 + x4.*x5.*x6.*x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                          (2.*(15.*x.^4 - 10.*x.^3.*x2 - 10.*x.^3.*x4 - 10.*x.^3.*x5 - 10.*x.^3.*x6 - 10.*x.^3.*x7 - 10.*x.^3.*x1 + 6.*x.^2.*x1.*x2 + 6.*x.^2.*x1.*x4 + 6.*x.^2.*x1.*x5 + 6.*x.^2.*x2.*x4 + 6.*x.^2.*x1.*x6 + 6.*x.^2.*x2.*x5 + 6.*x.^2.*x1.*x7 + 6.*x.^2.*x2.*x6 + 6.*x.^2.*x2.*x7 + 6.*x.^2.*x4.*x5 + 6.*x.^2.*x4.*x6 + 6.*x.^2.*x4.*x7 + 6.*x.^2.*x5.*x6 + 6.*x.^2.*x5.*x7 + 6.*x.^2.*x6.*x7 - 3.*x.*x1.*x2.*x4 - 3.*x.*x1.*x2.*x5 - 3.*x.*x1.*x2.*x6 - 3.*x.*x1.*x2.*x7 - 3.*x.*x1.*x4.*x5 - 3.*x.*x1.*x4.*x6 - 3.*x.*x2.*x4.*x5 - 3.*x.*x1.*x4.*x7 - 3.*x.*x1.*x5.*x6 - 3.*x.*x2.*x4.*x6 + x1.*x2.*x4.*x5 - 3.*x.*x1.*x5.*x7 - 3.*x.*x2.*x4.*x7 - 3.*x.*x2.*x5.*x6 + x1.*x2.*x4.*x6 - 3.*x.*x1.*x6.*x7 - 3.*x.*x2.*x5.*x7 + x1.*x2.*x4.*x7 + x1.*x2.*x5.*x6 - 3.*x.*x2.*x6.*x7 - 3.*x.*x4.*x5.*x6 + x1.*x2.*x5.*x7 - 3.*x.*x4.*x5.*x7 + x1.*x2.*x6.*x7 + x1.*x4.*x5.*x6 - 3.*x.*x4.*x6.*x7 + x1.*x4.*x5.*x7 + x2.*x4.*x5.*x6 - 3.*x.*x5.*x6.*x7 + x1.*x4.*x6.*x7 + x2.*x4.*x5.*x7 + x1.*x5.*x6.*x7 + x2.*x4.*x6.*x7 + x2.*x5.*x6.*x7 + x4.*x5.*x6.*x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                         -(2.*(15.*x.^4 - 10.*x.^3.*x2 - 10.*x.^3.*x3 - 10.*x.^3.*x5 - 10.*x.^3.*x6 - 10.*x.^3.*x7 - 10.*x.^3.*x1 + 6.*x.^2.*x1.*x2 + 6.*x.^2.*x1.*x3 + 6.*x.^2.*x2.*x3 + 6.*x.^2.*x1.*x5 + 6.*x.^2.*x1.*x6 + 6.*x.^2.*x2.*x5 + 6.*x.^2.*x1.*x7 + 6.*x.^2.*x2.*x6 + 6.*x.^2.*x3.*x5 + 6.*x.^2.*x2.*x7 + 6.*x.^2.*x3.*x6 + 6.*x.^2.*x3.*x7 + 6.*x.^2.*x5.*x6 + 6.*x.^2.*x5.*x7 + 6.*x.^2.*x6.*x7 - 3.*x.*x1.*x2.*x3 - 3.*x.*x1.*x2.*x5 - 3.*x.*x1.*x2.*x6 - 3.*x.*x1.*x3.*x5 - 3.*x.*x1.*x2.*x7 - 3.*x.*x1.*x3.*x6 - 3.*x.*x2.*x3.*x5 - 3.*x.*x1.*x3.*x7 - 3.*x.*x2.*x3.*x6 + x1.*x2.*x3.*x5 - 3.*x.*x1.*x5.*x6 - 3.*x.*x2.*x3.*x7 + x1.*x2.*x3.*x6 - 3.*x.*x1.*x5.*x7 - 3.*x.*x2.*x5.*x6 + x1.*x2.*x3.*x7 - 3.*x.*x1.*x6.*x7 - 3.*x.*x2.*x5.*x7 - 3.*x.*x3.*x5.*x6 + x1.*x2.*x5.*x6 - 3.*x.*x2.*x6.*x7 - 3.*x.*x3.*x5.*x7 + x1.*x2.*x5.*x7 + x1.*x3.*x5.*x6 - 3.*x.*x3.*x6.*x7 + x1.*x2.*x6.*x7 + x1.*x3.*x5.*x7 + x2.*x3.*x5.*x6 + x1.*x3.*x6.*x7 + x2.*x3.*x5.*x7 - 3.*x.*x5.*x6.*x7 + x2.*x3.*x6.*x7 + x1.*x5.*x6.*x7 + x2.*x5.*x6.*x7 + x3.*x5.*x6.*x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                          (2.*(15.*x.^4 - 10.*x.^3.*x2 - 10.*x.^3.*x3 - 10.*x.^3.*x4 - 10.*x.^3.*x6 - 10.*x.^3.*x7 - 10.*x.^3.*x1 + 6.*x.^2.*x1.*x2 + 6.*x.^2.*x1.*x3 + 6.*x.^2.*x1.*x4 + 6.*x.^2.*x2.*x3 + 6.*x.^2.*x2.*x4 + 6.*x.^2.*x1.*x6 + 6.*x.^2.*x3.*x4 + 6.*x.^2.*x1.*x7 + 6.*x.^2.*x2.*x6 + 6.*x.^2.*x2.*x7 + 6.*x.^2.*x3.*x6 + 6.*x.^2.*x3.*x7 + 6.*x.^2.*x4.*x6 + 6.*x.^2.*x4.*x7 + 6.*x.^2.*x6.*x7 - 3.*x.*x1.*x2.*x3 - 3.*x.*x1.*x2.*x4 - 3.*x.*x1.*x3.*x4 - 3.*x.*x1.*x2.*x6 - 3.*x.*x2.*x3.*x4 - 3.*x.*x1.*x2.*x7 - 3.*x.*x1.*x3.*x6 + x1.*x2.*x3.*x4 - 3.*x.*x1.*x3.*x7 - 3.*x.*x1.*x4.*x6 - 3.*x.*x2.*x3.*x6 - 3.*x.*x1.*x4.*x7 - 3.*x.*x2.*x3.*x7 - 3.*x.*x2.*x4.*x6 + x1.*x2.*x3.*x6 - 3.*x.*x2.*x4.*x7 - 3.*x.*x3.*x4.*x6 + x1.*x2.*x3.*x7 + x1.*x2.*x4.*x6 - 3.*x.*x1.*x6.*x7 - 3.*x.*x3.*x4.*x7 + x1.*x2.*x4.*x7 + x1.*x3.*x4.*x6 - 3.*x.*x2.*x6.*x7 + x1.*x3.*x4.*x7 + x2.*x3.*x4.*x6 - 3.*x.*x3.*x6.*x7 + x1.*x2.*x6.*x7 + x2.*x3.*x4.*x7 - 3.*x.*x4.*x6.*x7 + x1.*x3.*x6.*x7 + x1.*x4.*x6.*x7 + x2.*x3.*x6.*x7 + x2.*x4.*x6.*x7 + x3.*x4.*x6.*x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                          -(2.*(15.*x.^4 - 10.*x.^3.*x2 - 10.*x.^3.*x3 - 10.*x.^3.*x4 - 10.*x.^3.*x5 - 10.*x.^3.*x7 - 10.*x.^3.*x1 + 6.*x.^2.*x1.*x2 + 6.*x.^2.*x1.*x3 + 6.*x.^2.*x1.*x4 + 6.*x.^2.*x2.*x3 + 6.*x.^2.*x1.*x5 + 6.*x.^2.*x2.*x4 + 6.*x.^2.*x2.*x5 + 6.*x.^2.*x3.*x4 + 6.*x.^2.*x1.*x7 + 6.*x.^2.*x3.*x5 + 6.*x.^2.*x2.*x7 + 6.*x.^2.*x4.*x5 + 6.*x.^2.*x3.*x7 + 6.*x.^2.*x4.*x7 + 6.*x.^2.*x5.*x7 - 3.*x.*x1.*x2.*x3 - 3.*x.*x1.*x2.*x4 - 3.*x.*x1.*x2.*x5 - 3.*x.*x1.*x3.*x4 - 3.*x.*x1.*x3.*x5 - 3.*x.*x2.*x3.*x4 - 3.*x.*x1.*x2.*x7 - 3.*x.*x1.*x4.*x5 - 3.*x.*x2.*x3.*x5 + x1.*x2.*x3.*x4 - 3.*x.*x1.*x3.*x7 - 3.*x.*x2.*x4.*x5 + x1.*x2.*x3.*x5 - 3.*x.*x1.*x4.*x7 - 3.*x.*x2.*x3.*x7 - 3.*x.*x3.*x4.*x5 + x1.*x2.*x4.*x5 - 3.*x.*x1.*x5.*x7 - 3.*x.*x2.*x4.*x7 + x1.*x2.*x3.*x7 + x1.*x3.*x4.*x5 - 3.*x.*x2.*x5.*x7 - 3.*x.*x3.*x4.*x7 + x1.*x2.*x4.*x7 + x2.*x3.*x4.*x5 - 3.*x.*x3.*x5.*x7 + x1.*x2.*x5.*x7 + x1.*x3.*x4.*x7 - 3.*x.*x4.*x5.*x7 + x1.*x3.*x5.*x7 + x2.*x3.*x4.*x7 + x1.*x4.*x5.*x7 + x2.*x3.*x5.*x7 + x2.*x4.*x5.*x7 + x3.*x4.*x5.*x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                           (2.*(15.*x.^4 - 10.*x.^3.*x2 - 10.*x.^3.*x3 - 10.*x.^3.*x4 - 10.*x.^3.*x5 - 10.*x.^3.*x6 - 10.*x.^3.*x1 + 6.*x.^2.*x1.*x2 + 6.*x.^2.*x1.*x3 + 6.*x.^2.*x1.*x4 + 6.*x.^2.*x2.*x3 + 6.*x.^2.*x1.*x5 + 6.*x.^2.*x2.*x4 + 6.*x.^2.*x1.*x6 + 6.*x.^2.*x2.*x5 + 6.*x.^2.*x3.*x4 + 6.*x.^2.*x2.*x6 + 6.*x.^2.*x3.*x5 + 6.*x.^2.*x3.*x6 + 6.*x.^2.*x4.*x5 + 6.*x.^2.*x4.*x6 + 6.*x.^2.*x5.*x6 - 3.*x.*x1.*x2.*x3 - 3.*x.*x1.*x2.*x4 - 3.*x.*x1.*x2.*x5 - 3.*x.*x1.*x3.*x4 - 3.*x.*x1.*x2.*x6 - 3.*x.*x1.*x3.*x5 - 3.*x.*x2.*x3.*x4 - 3.*x.*x1.*x3.*x6 - 3.*x.*x1.*x4.*x5 - 3.*x.*x2.*x3.*x5 + x1.*x2.*x3.*x4 - 3.*x.*x1.*x4.*x6 - 3.*x.*x2.*x3.*x6 - 3.*x.*x2.*x4.*x5 + x1.*x2.*x3.*x5 - 3.*x.*x1.*x5.*x6 - 3.*x.*x2.*x4.*x6 - 3.*x.*x3.*x4.*x5 + x1.*x2.*x3.*x6 + x1.*x2.*x4.*x5 - 3.*x.*x2.*x5.*x6 - 3.*x.*x3.*x4.*x6 + x1.*x2.*x4.*x6 + x1.*x3.*x4.*x5 - 3.*x.*x3.*x5.*x6 + x1.*x2.*x5.*x6 + x1.*x3.*x4.*x6 + x2.*x3.*x4.*x5 - 3.*x.*x4.*x5.*x6 + x1.*x3.*x5.*x6 + x2.*x3.*x4.*x6 + x1.*x4.*x5.*x6 + x2.*x3.*x5.*x6 + x2.*x4.*x5.*x6 + x3.*x4.*x5.*x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) ];
            case 3
                dnL=[-(2.*(30.*x.^2.*x2 + 30.*x.^2.*x3 + 30.*x.^2.*x4 + 30.*x.^2.*x5 + 30.*x.^2.*x6 + 30.*x.^2.*x7 - 60.*x.^3 - 12.*x.*x2.*x3 - 12.*x.*x2.*x4 - 12.*x.*x2.*x5 - 12.*x.*x3.*x4 - 12.*x.*x2.*x6 - 12.*x.*x3.*x5 - 12.*x.*x2.*x7 - 12.*x.*x3.*x6 - 12.*x.*x4.*x5 + 3.*x2.*x3.*x4 - 12.*x.*x3.*x7 - 12.*x.*x4.*x6 + 3.*x2.*x3.*x5 - 12.*x.*x4.*x7 - 12.*x.*x5.*x6 + 3.*x2.*x3.*x6 + 3.*x2.*x4.*x5 - 12.*x.*x5.*x7 + 3.*x2.*x3.*x7 + 3.*x2.*x4.*x6 + 3.*x3.*x4.*x5 - 12.*x.*x6.*x7 + 3.*x2.*x4.*x7 + 3.*x2.*x5.*x6 + 3.*x3.*x4.*x6 + 3.*x2.*x5.*x7 + 3.*x3.*x4.*x7 + 3.*x3.*x5.*x6 + 3.*x2.*x6.*x7 + 3.*x3.*x5.*x7 + 3.*x4.*x5.*x6 + 3.*x3.*x6.*x7 + 3.*x4.*x5.*x7 + 3.*x4.*x6.*x7 + 3.*x5.*x6.*x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                           (2.*(30.*x.^2.*x1 + 30.*x.^2.*x3 + 30.*x.^2.*x4 + 30.*x.^2.*x5 + 30.*x.^2.*x6 + 30.*x.^2.*x7 - 60.*x.^3 - 12.*x.*x1.*x3 - 12.*x.*x1.*x4 - 12.*x.*x1.*x5 - 12.*x.*x1.*x6 - 12.*x.*x3.*x4 - 12.*x.*x1.*x7 - 12.*x.*x3.*x5 + 3.*x1.*x3.*x4 - 12.*x.*x3.*x6 - 12.*x.*x4.*x5 + 3.*x1.*x3.*x5 - 12.*x.*x3.*x7 - 12.*x.*x4.*x6 + 3.*x1.*x3.*x6 + 3.*x1.*x4.*x5 - 12.*x.*x4.*x7 - 12.*x.*x5.*x6 + 3.*x1.*x3.*x7 + 3.*x1.*x4.*x6 - 12.*x.*x5.*x7 + 3.*x1.*x4.*x7 + 3.*x1.*x5.*x6 + 3.*x3.*x4.*x5 - 12.*x.*x6.*x7 + 3.*x1.*x5.*x7 + 3.*x3.*x4.*x6 + 3.*x1.*x6.*x7 + 3.*x3.*x4.*x7 + 3.*x3.*x5.*x6 + 3.*x3.*x5.*x7 + 3.*x4.*x5.*x6 + 3.*x3.*x6.*x7 + 3.*x4.*x5.*x7 + 3.*x4.*x6.*x7 + 3.*x5.*x6.*x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                          -(2.*(30.*x.^2.*x1 + 30.*x.^2.*x2 + 30.*x.^2.*x4 + 30.*x.^2.*x5 + 30.*x.^2.*x6 + 30.*x.^2.*x7 - 60.*x.^3 - 12.*x.*x1.*x2 - 12.*x.*x1.*x4 - 12.*x.*x1.*x5 - 12.*x.*x2.*x4 - 12.*x.*x1.*x6 - 12.*x.*x2.*x5 + 3.*x1.*x2.*x4 - 12.*x.*x1.*x7 - 12.*x.*x2.*x6 + 3.*x1.*x2.*x5 - 12.*x.*x2.*x7 - 12.*x.*x4.*x5 + 3.*x1.*x2.*x6 - 12.*x.*x4.*x6 + 3.*x1.*x2.*x7 + 3.*x1.*x4.*x5 - 12.*x.*x4.*x7 - 12.*x.*x5.*x6 + 3.*x1.*x4.*x6 + 3.*x2.*x4.*x5 - 12.*x.*x5.*x7 + 3.*x1.*x4.*x7 + 3.*x1.*x5.*x6 + 3.*x2.*x4.*x6 - 12.*x.*x6.*x7 + 3.*x1.*x5.*x7 + 3.*x2.*x4.*x7 + 3.*x2.*x5.*x6 + 3.*x1.*x6.*x7 + 3.*x2.*x5.*x7 + 3.*x2.*x6.*x7 + 3.*x4.*x5.*x6 + 3.*x4.*x5.*x7 + 3.*x4.*x6.*x7 + 3.*x5.*x6.*x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                           (2.*(30.*x.^2.*x1 + 30.*x.^2.*x2 + 30.*x.^2.*x3 + 30.*x.^2.*x5 + 30.*x.^2.*x6 + 30.*x.^2.*x7 - 60.*x.^3 - 12.*x.*x1.*x2 - 12.*x.*x1.*x3 - 12.*x.*x2.*x3 - 12.*x.*x1.*x5 + 3.*x1.*x2.*x3 - 12.*x.*x1.*x6 - 12.*x.*x2.*x5 - 12.*x.*x1.*x7 - 12.*x.*x2.*x6 - 12.*x.*x3.*x5 + 3.*x1.*x2.*x5 - 12.*x.*x2.*x7 - 12.*x.*x3.*x6 + 3.*x1.*x2.*x6 + 3.*x1.*x3.*x5 - 12.*x.*x3.*x7 + 3.*x1.*x2.*x7 + 3.*x1.*x3.*x6 + 3.*x2.*x3.*x5 - 12.*x.*x5.*x6 + 3.*x1.*x3.*x7 + 3.*x2.*x3.*x6 - 12.*x.*x5.*x7 + 3.*x1.*x5.*x6 + 3.*x2.*x3.*x7 - 12.*x.*x6.*x7 + 3.*x1.*x5.*x7 + 3.*x2.*x5.*x6 + 3.*x1.*x6.*x7 + 3.*x2.*x5.*x7 + 3.*x3.*x5.*x6 + 3.*x2.*x6.*x7 + 3.*x3.*x5.*x7 + 3.*x3.*x6.*x7 + 3.*x5.*x6.*x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                          -(2.*(30.*x.^2.*x1 + 30.*x.^2.*x2 + 30.*x.^2.*x3 + 30.*x.^2.*x4 + 30.*x.^2.*x6 + 30.*x.^2.*x7 - 60.*x.^3 - 12.*x.*x1.*x2 - 12.*x.*x1.*x3 - 12.*x.*x1.*x4 - 12.*x.*x2.*x3 - 12.*x.*x2.*x4 + 3.*x1.*x2.*x3 - 12.*x.*x1.*x6 - 12.*x.*x3.*x4 + 3.*x1.*x2.*x4 - 12.*x.*x1.*x7 - 12.*x.*x2.*x6 + 3.*x1.*x3.*x4 - 12.*x.*x2.*x7 - 12.*x.*x3.*x6 + 3.*x1.*x2.*x6 + 3.*x2.*x3.*x4 - 12.*x.*x3.*x7 - 12.*x.*x4.*x6 + 3.*x1.*x2.*x7 + 3.*x1.*x3.*x6 - 12.*x.*x4.*x7 + 3.*x1.*x3.*x7 + 3.*x1.*x4.*x6 + 3.*x2.*x3.*x6 + 3.*x1.*x4.*x7 + 3.*x2.*x3.*x7 + 3.*x2.*x4.*x6 - 12.*x.*x6.*x7 + 3.*x2.*x4.*x7 + 3.*x3.*x4.*x6 + 3.*x1.*x6.*x7 + 3.*x3.*x4.*x7 + 3.*x2.*x6.*x7 + 3.*x3.*x6.*x7 + 3.*x4.*x6.*x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                           (2.*(30.*x.^2.*x1 + 30.*x.^2.*x2 + 30.*x.^2.*x3 + 30.*x.^2.*x4 + 30.*x.^2.*x5 + 30.*x.^2.*x7 - 60.*x.^3 - 12.*x.*x1.*x2 - 12.*x.*x1.*x3 - 12.*x.*x1.*x4 - 12.*x.*x2.*x3 - 12.*x.*x1.*x5 - 12.*x.*x2.*x4 + 3.*x1.*x2.*x3 - 12.*x.*x2.*x5 - 12.*x.*x3.*x4 + 3.*x1.*x2.*x4 - 12.*x.*x1.*x7 - 12.*x.*x3.*x5 + 3.*x1.*x2.*x5 + 3.*x1.*x3.*x4 - 12.*x.*x2.*x7 - 12.*x.*x4.*x5 + 3.*x1.*x3.*x5 + 3.*x2.*x3.*x4 - 12.*x.*x3.*x7 + 3.*x1.*x2.*x7 + 3.*x1.*x4.*x5 + 3.*x2.*x3.*x5 - 12.*x.*x4.*x7 + 3.*x1.*x3.*x7 + 3.*x2.*x4.*x5 - 12.*x.*x5.*x7 + 3.*x1.*x4.*x7 + 3.*x2.*x3.*x7 + 3.*x3.*x4.*x5 + 3.*x1.*x5.*x7 + 3.*x2.*x4.*x7 + 3.*x2.*x5.*x7 + 3.*x3.*x4.*x7 + 3.*x3.*x5.*x7 + 3.*x4.*x5.*x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                          -(2.*(30.*x.^2.*x1 + 30.*x.^2.*x2 + 30.*x.^2.*x3 + 30.*x.^2.*x4 + 30.*x.^2.*x5 + 30.*x.^2.*x6 - 60.*x.^3 - 12.*x.*x1.*x2 - 12.*x.*x1.*x3 - 12.*x.*x1.*x4 - 12.*x.*x2.*x3 - 12.*x.*x1.*x5 - 12.*x.*x2.*x4 + 3.*x1.*x2.*x3 - 12.*x.*x1.*x6 - 12.*x.*x2.*x5 - 12.*x.*x3.*x4 + 3.*x1.*x2.*x4 - 12.*x.*x2.*x6 - 12.*x.*x3.*x5 + 3.*x1.*x2.*x5 + 3.*x1.*x3.*x4 - 12.*x.*x3.*x6 - 12.*x.*x4.*x5 + 3.*x1.*x2.*x6 + 3.*x1.*x3.*x5 + 3.*x2.*x3.*x4 - 12.*x.*x4.*x6 + 3.*x1.*x3.*x6 + 3.*x1.*x4.*x5 + 3.*x2.*x3.*x5 - 12.*x.*x5.*x6 + 3.*x1.*x4.*x6 + 3.*x2.*x3.*x6 + 3.*x2.*x4.*x5 + 3.*x1.*x5.*x6 + 3.*x2.*x4.*x6 + 3.*x3.*x4.*x5 + 3.*x2.*x5.*x6 + 3.*x3.*x4.*x6 + 3.*x3.*x5.*x6 + 3.*x4.*x5.*x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) ];
            case 4
                dnL=[(2.*(12.*x2.*x3 - 60.*x.*x3 - 60.*x.*x4 - 60.*x.*x5 - 60.*x.*x2 - 60.*x.*x6 + 12.*x2.*x4 - 60.*x.*x7 + 12.*x2.*x5 + 12.*x3.*x4 + 12.*x2.*x6 + 12.*x3.*x5 + 12.*x2.*x7 + 12.*x3.*x6 + 12.*x4.*x5 + 12.*x3.*x7 + 12.*x4.*x6 + 12.*x4.*x7 + 12.*x5.*x6 + 12.*x5.*x7 + 12.*x6.*x7 + 180.*x.^2))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                         -(2.*(12.*x1.*x3 - 60.*x.*x3 - 60.*x.*x4 - 60.*x.*x1 - 60.*x.*x5 + 12.*x1.*x4 - 60.*x.*x6 + 12.*x1.*x5 - 60.*x.*x7 + 12.*x1.*x6 + 12.*x3.*x4 + 12.*x1.*x7 + 12.*x3.*x5 + 12.*x3.*x6 + 12.*x4.*x5 + 12.*x3.*x7 + 12.*x4.*x6 + 12.*x4.*x7 + 12.*x5.*x6 + 12.*x5.*x7 + 12.*x6.*x7 + 180.*x.^2))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                          (2.*(12.*x1.*x2 - 60.*x.*x2 - 60.*x.*x1 - 60.*x.*x4 - 60.*x.*x5 + 12.*x1.*x4 - 60.*x.*x6 + 12.*x1.*x5 + 12.*x2.*x4 - 60.*x.*x7 + 12.*x1.*x6 + 12.*x2.*x5 + 12.*x1.*x7 + 12.*x2.*x6 + 12.*x2.*x7 + 12.*x4.*x5 + 12.*x4.*x6 + 12.*x4.*x7 + 12.*x5.*x6 + 12.*x5.*x7 + 12.*x6.*x7 + 180.*x.^2))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                         -(2.*(12.*x1.*x2 - 60.*x.*x2 - 60.*x.*x3 - 60.*x.*x1 + 12.*x1.*x3 - 60.*x.*x5 + 12.*x2.*x3 - 60.*x.*x6 + 12.*x1.*x5 - 60.*x.*x7 + 12.*x1.*x6 + 12.*x2.*x5 + 12.*x1.*x7 + 12.*x2.*x6 + 12.*x3.*x5 + 12.*x2.*x7 + 12.*x3.*x6 + 12.*x3.*x7 + 12.*x5.*x6 + 12.*x5.*x7 + 12.*x6.*x7 + 180.*x.^2))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                          (2.*(12.*x1.*x2 - 60.*x.*x2 - 60.*x.*x3 - 60.*x.*x1 - 60.*x.*x4 + 12.*x1.*x3 + 12.*x1.*x4 + 12.*x2.*x3 - 60.*x.*x6 + 12.*x2.*x4 - 60.*x.*x7 + 12.*x1.*x6 + 12.*x3.*x4 + 12.*x1.*x7 + 12.*x2.*x6 + 12.*x2.*x7 + 12.*x3.*x6 + 12.*x3.*x7 + 12.*x4.*x6 + 12.*x4.*x7 + 12.*x6.*x7 + 180.*x.^2))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                         -(2.*(12.*x1.*x2 - 60.*x.*x2 - 60.*x.*x3 - 60.*x.*x1 - 60.*x.*x4 + 12.*x1.*x3 - 60.*x.*x5 + 12.*x1.*x4 + 12.*x2.*x3 + 12.*x1.*x5 + 12.*x2.*x4 - 60.*x.*x7 + 12.*x2.*x5 + 12.*x3.*x4 + 12.*x1.*x7 + 12.*x3.*x5 + 12.*x2.*x7 + 12.*x4.*x5 + 12.*x3.*x7 + 12.*x4.*x7 + 12.*x5.*x7 + 180.*x.^2))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                          (2.*(12.*x1.*x2 - 60.*x.*x2 - 60.*x.*x3 - 60.*x.*x1 - 60.*x.*x4 + 12.*x1.*x3 - 60.*x.*x5 + 12.*x1.*x4 + 12.*x2.*x3 - 60.*x.*x6 + 12.*x1.*x5 + 12.*x2.*x4 + 12.*x1.*x6 + 12.*x2.*x5 + 12.*x3.*x4 + 12.*x2.*x6 + 12.*x3.*x5 + 12.*x3.*x6 + 12.*x4.*x5 + 12.*x4.*x6 + 12.*x5.*x6 + 180.*x.^2))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) ];
            case 5
                dnL=[-(2.*(60.*x2 - 360.*x + 60.*x3 + 60.*x4 + 60.*x5 + 60.*x6 + 60.*x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                           (2.*(60.*x1 - 360.*x + 60.*x3 + 60.*x4 + 60.*x5 + 60.*x6 + 60.*x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                          -(2.*(60.*x1 - 360.*x + 60.*x2 + 60.*x4 + 60.*x5 + 60.*x6 + 60.*x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                           (2.*(60.*x1 - 360.*x + 60.*x2 + 60.*x3 + 60.*x5 + 60.*x6 + 60.*x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                          -(2.*(60.*x1 - 360.*x + 60.*x2 + 60.*x3 + 60.*x4 + 60.*x6 + 60.*x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                           (2.*(60.*x1 - 360.*x + 60.*x2 + 60.*x3 + 60.*x4 + 60.*x5 + 60.*x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                          -(2.*(60.*x1 - 360.*x + 60.*x2 + 60.*x3 + 60.*x4 + 60.*x5 + 60.*x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7)) ];
            case 6
                dnL1=[720/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7))
                        -720/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7))
                          720/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7))
                         -720/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7))
                          720/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7))
                         -720/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7))
                          720/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7))];
                 n=7; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(7,length(x));
        end
    case 7
        x1=knots(1); x2=knots(2); x3=knots(3); x4=knots(4); x5=knots(5); x6=knots(6); x7=knots(7);  x8=knots(8); 
        switch der
            case 0
                dnL=[ ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                     -((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                      ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                     -((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                      ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                     -((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                      ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                     -((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 1
                dnL=[  ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8)) + ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8)) + ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8)) + ((x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8)) + ((x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8)) + ((x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8)) + ((x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                     - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8)) - ((x - x1).*(x - x3).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8)) - ((x - x1).*(x - x3).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8)) - ((x - x1).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8)) - ((x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                       ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8)) + ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8)) + ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8)) + ((x - x1).*(x - x2).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8)) + ((x - x1).*(x - x2).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8)) + ((x - x1).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8)) + ((x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                     - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x7).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x6).*(x - x7).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8)) - ((x - x1).*(x - x2).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8)) - ((x - x1).*(x - x3).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8)) - ((x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7).*(x - x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                       ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8)) + ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8)) + ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x7).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8)) + ((x - x1).*(x - x2).*(x - x3).*(x - x6).*(x - x7).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8)) + ((x - x1).*(x - x2).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8)) + ((x - x1).*(x - x3).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8)) + ((x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7).*(x - x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                     - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x7).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x7).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8)) - ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8)) - ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7).*(x - x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                       ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8)) + ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8)) + ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8)) + ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8)) + ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8)) + ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8)) + ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                     - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x4).*(x - x6).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8)) - ((x - x1).*(x - x2).*(x - x3).*(x - x5).*(x - x6).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8)) - ((x - x1).*(x - x2).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8)) - ((x - x1).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8)) - ((x - x2).*(x - x3).*(x - x4).*(x - x5).*(x - x6).*(x - x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 2
                dnL=[-(2.*(15.*x.^4.*x2 + 15.*x.^4.*x3 + 15.*x.^4.*x4 + 15.*x.^4.*x5 + 15.*x.^4.*x6 + 15.*x.^4.*x7 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x2.*x3 - 10.*x.^3.*x2.*x4 - 10.*x.^3.*x2.*x5 - 10.*x.^3.*x3.*x4 - 10.*x.^3.*x2.*x6 - 10.*x.^3.*x3.*x5 - 10.*x.^3.*x2.*x7 - 10.*x.^3.*x3.*x6 - 10.*x.^3.*x4.*x5 - 10.*x.^3.*x2.*x8 - 10.*x.^3.*x3.*x7 - 10.*x.^3.*x4.*x6 - 10.*x.^3.*x3.*x8 - 10.*x.^3.*x4.*x7 - 10.*x.^3.*x5.*x6 - 10.*x.^3.*x4.*x8 - 10.*x.^3.*x5.*x7 - 10.*x.^3.*x5.*x8 - 10.*x.^3.*x6.*x7 - 10.*x.^3.*x6.*x8 - 10.*x.^3.*x7.*x8 + 6.*x.^2.*x2.*x3.*x4 + 6.*x.^2.*x2.*x3.*x5 + 6.*x.^2.*x2.*x3.*x6 + 6.*x.^2.*x2.*x4.*x5 + 6.*x.^2.*x2.*x3.*x7 + 6.*x.^2.*x2.*x4.*x6 + 6.*x.^2.*x3.*x4.*x5 + 6.*x.^2.*x2.*x3.*x8 + 6.*x.^2.*x2.*x4.*x7 + 6.*x.^2.*x2.*x5.*x6 + 6.*x.^2.*x3.*x4.*x6 + 6.*x.^2.*x2.*x4.*x8 + 6.*x.^2.*x2.*x5.*x7 + 6.*x.^2.*x3.*x4.*x7 + 6.*x.^2.*x3.*x5.*x6 + 6.*x.^2.*x2.*x5.*x8 + 6.*x.^2.*x2.*x6.*x7 + 6.*x.^2.*x3.*x4.*x8 + 6.*x.^2.*x3.*x5.*x7 + 6.*x.^2.*x4.*x5.*x6 + 6.*x.^2.*x2.*x6.*x8 + 6.*x.^2.*x3.*x5.*x8 + 6.*x.^2.*x3.*x6.*x7 + 6.*x.^2.*x4.*x5.*x7 + 6.*x.^2.*x2.*x7.*x8 + 6.*x.^2.*x3.*x6.*x8 + 6.*x.^2.*x4.*x5.*x8 + 6.*x.^2.*x4.*x6.*x7 + 6.*x.^2.*x3.*x7.*x8 + 6.*x.^2.*x4.*x6.*x8 + 6.*x.^2.*x5.*x6.*x7 + 6.*x.^2.*x4.*x7.*x8 + 6.*x.^2.*x5.*x6.*x8 + 6.*x.^2.*x5.*x7.*x8 + 6.*x.^2.*x6.*x7.*x8 - 3.*x.*x2.*x3.*x4.*x5 - 3.*x.*x2.*x3.*x4.*x6 - 3.*x.*x2.*x3.*x4.*x7 - 3.*x.*x2.*x3.*x5.*x6 - 3.*x.*x2.*x3.*x4.*x8 - 3.*x.*x2.*x3.*x5.*x7 - 3.*x.*x2.*x4.*x5.*x6 - 3.*x.*x2.*x3.*x5.*x8 - 3.*x.*x2.*x3.*x6.*x7 - 3.*x.*x2.*x4.*x5.*x7 - 3.*x.*x3.*x4.*x5.*x6 - 3.*x.*x2.*x3.*x6.*x8 - 3.*x.*x2.*x4.*x5.*x8 - 3.*x.*x2.*x4.*x6.*x7 - 3.*x.*x3.*x4.*x5.*x7 - 3.*x.*x2.*x3.*x7.*x8 - 3.*x.*x2.*x4.*x6.*x8 - 3.*x.*x2.*x5.*x6.*x7 - 3.*x.*x3.*x4.*x5.*x8 - 3.*x.*x3.*x4.*x6.*x7 + x2.*x3.*x4.*x5.*x6 - 3.*x.*x2.*x4.*x7.*x8 - 3.*x.*x2.*x5.*x6.*x8 - 3.*x.*x3.*x4.*x6.*x8 - 3.*x.*x3.*x5.*x6.*x7 + x2.*x3.*x4.*x5.*x7 - 3.*x.*x2.*x5.*x7.*x8 - 3.*x.*x3.*x4.*x7.*x8 - 3.*x.*x3.*x5.*x6.*x8 - 3.*x.*x4.*x5.*x6.*x7 + x2.*x3.*x4.*x5.*x8 + x2.*x3.*x4.*x6.*x7 - 3.*x.*x2.*x6.*x7.*x8 - 3.*x.*x3.*x5.*x7.*x8 - 3.*x.*x4.*x5.*x6.*x8 + x2.*x3.*x4.*x6.*x8 + x2.*x3.*x5.*x6.*x7 - 3.*x.*x3.*x6.*x7.*x8 - 3.*x.*x4.*x5.*x7.*x8 + x2.*x3.*x4.*x7.*x8 + x2.*x3.*x5.*x6.*x8 + x2.*x4.*x5.*x6.*x7 - 3.*x.*x4.*x6.*x7.*x8 + x2.*x3.*x5.*x7.*x8 + x2.*x4.*x5.*x6.*x8 + x3.*x4.*x5.*x6.*x7 - 3.*x.*x5.*x6.*x7.*x8 + x2.*x3.*x6.*x7.*x8 + x2.*x4.*x5.*x7.*x8 + x3.*x4.*x5.*x6.*x8 + x2.*x4.*x6.*x7.*x8 + x3.*x4.*x5.*x7.*x8 + x2.*x5.*x6.*x7.*x8 + x3.*x4.*x6.*x7.*x8 + x3.*x5.*x6.*x7.*x8 + x4.*x5.*x6.*x7.*x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                      (2.*(15.*x.^4.*x1 + 15.*x.^4.*x3 + 15.*x.^4.*x4 + 15.*x.^4.*x5 + 15.*x.^4.*x6 + 15.*x.^4.*x7 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x1.*x3 - 10.*x.^3.*x1.*x4 - 10.*x.^3.*x1.*x5 - 10.*x.^3.*x1.*x6 - 10.*x.^3.*x3.*x4 - 10.*x.^3.*x1.*x7 - 10.*x.^3.*x3.*x5 - 10.*x.^3.*x1.*x8 - 10.*x.^3.*x3.*x6 - 10.*x.^3.*x4.*x5 - 10.*x.^3.*x3.*x7 - 10.*x.^3.*x4.*x6 - 10.*x.^3.*x3.*x8 - 10.*x.^3.*x4.*x7 - 10.*x.^3.*x5.*x6 - 10.*x.^3.*x4.*x8 - 10.*x.^3.*x5.*x7 - 10.*x.^3.*x5.*x8 - 10.*x.^3.*x6.*x7 - 10.*x.^3.*x6.*x8 - 10.*x.^3.*x7.*x8 + 6.*x.^2.*x1.*x3.*x4 + 6.*x.^2.*x1.*x3.*x5 + 6.*x.^2.*x1.*x3.*x6 + 6.*x.^2.*x1.*x4.*x5 + 6.*x.^2.*x1.*x3.*x7 + 6.*x.^2.*x1.*x4.*x6 + 6.*x.^2.*x1.*x3.*x8 + 6.*x.^2.*x1.*x4.*x7 + 6.*x.^2.*x1.*x5.*x6 + 6.*x.^2.*x3.*x4.*x5 + 6.*x.^2.*x1.*x4.*x8 + 6.*x.^2.*x1.*x5.*x7 + 6.*x.^2.*x3.*x4.*x6 + 6.*x.^2.*x1.*x5.*x8 + 6.*x.^2.*x1.*x6.*x7 + 6.*x.^2.*x3.*x4.*x7 + 6.*x.^2.*x3.*x5.*x6 + 6.*x.^2.*x1.*x6.*x8 + 6.*x.^2.*x3.*x4.*x8 + 6.*x.^2.*x3.*x5.*x7 + 6.*x.^2.*x4.*x5.*x6 + 6.*x.^2.*x1.*x7.*x8 + 6.*x.^2.*x3.*x5.*x8 + 6.*x.^2.*x3.*x6.*x7 + 6.*x.^2.*x4.*x5.*x7 + 6.*x.^2.*x3.*x6.*x8 + 6.*x.^2.*x4.*x5.*x8 + 6.*x.^2.*x4.*x6.*x7 + 6.*x.^2.*x3.*x7.*x8 + 6.*x.^2.*x4.*x6.*x8 + 6.*x.^2.*x5.*x6.*x7 + 6.*x.^2.*x4.*x7.*x8 + 6.*x.^2.*x5.*x6.*x8 + 6.*x.^2.*x5.*x7.*x8 + 6.*x.^2.*x6.*x7.*x8 - 3.*x.*x1.*x3.*x4.*x5 - 3.*x.*x1.*x3.*x4.*x6 - 3.*x.*x1.*x3.*x4.*x7 - 3.*x.*x1.*x3.*x5.*x6 - 3.*x.*x1.*x3.*x4.*x8 - 3.*x.*x1.*x3.*x5.*x7 - 3.*x.*x1.*x4.*x5.*x6 - 3.*x.*x1.*x3.*x5.*x8 - 3.*x.*x1.*x3.*x6.*x7 - 3.*x.*x1.*x4.*x5.*x7 - 3.*x.*x1.*x3.*x6.*x8 - 3.*x.*x1.*x4.*x5.*x8 - 3.*x.*x1.*x4.*x6.*x7 - 3.*x.*x3.*x4.*x5.*x6 - 3.*x.*x1.*x3.*x7.*x8 - 3.*x.*x1.*x4.*x6.*x8 - 3.*x.*x1.*x5.*x6.*x7 - 3.*x.*x3.*x4.*x5.*x7 + x1.*x3.*x4.*x5.*x6 - 3.*x.*x1.*x4.*x7.*x8 - 3.*x.*x1.*x5.*x6.*x8 - 3.*x.*x3.*x4.*x5.*x8 - 3.*x.*x3.*x4.*x6.*x7 + x1.*x3.*x4.*x5.*x7 - 3.*x.*x1.*x5.*x7.*x8 - 3.*x.*x3.*x4.*x6.*x8 - 3.*x.*x3.*x5.*x6.*x7 + x1.*x3.*x4.*x5.*x8 + x1.*x3.*x4.*x6.*x7 - 3.*x.*x1.*x6.*x7.*x8 - 3.*x.*x3.*x4.*x7.*x8 - 3.*x.*x3.*x5.*x6.*x8 - 3.*x.*x4.*x5.*x6.*x7 + x1.*x3.*x4.*x6.*x8 + x1.*x3.*x5.*x6.*x7 - 3.*x.*x3.*x5.*x7.*x8 - 3.*x.*x4.*x5.*x6.*x8 + x1.*x3.*x4.*x7.*x8 + x1.*x3.*x5.*x6.*x8 + x1.*x4.*x5.*x6.*x7 - 3.*x.*x3.*x6.*x7.*x8 - 3.*x.*x4.*x5.*x7.*x8 + x1.*x3.*x5.*x7.*x8 + x1.*x4.*x5.*x6.*x8 - 3.*x.*x4.*x6.*x7.*x8 + x1.*x3.*x6.*x7.*x8 + x1.*x4.*x5.*x7.*x8 + x3.*x4.*x5.*x6.*x7 - 3.*x.*x5.*x6.*x7.*x8 + x1.*x4.*x6.*x7.*x8 + x3.*x4.*x5.*x6.*x8 + x1.*x5.*x6.*x7.*x8 + x3.*x4.*x5.*x7.*x8 + x3.*x4.*x6.*x7.*x8 + x3.*x5.*x6.*x7.*x8 + x4.*x5.*x6.*x7.*x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                     -(2.*(15.*x.^4.*x1 + 15.*x.^4.*x2 + 15.*x.^4.*x4 + 15.*x.^4.*x5 + 15.*x.^4.*x6 + 15.*x.^4.*x7 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x1.*x2 - 10.*x.^3.*x1.*x4 - 10.*x.^3.*x1.*x5 - 10.*x.^3.*x2.*x4 - 10.*x.^3.*x1.*x6 - 10.*x.^3.*x2.*x5 - 10.*x.^3.*x1.*x7 - 10.*x.^3.*x2.*x6 - 10.*x.^3.*x1.*x8 - 10.*x.^3.*x2.*x7 - 10.*x.^3.*x4.*x5 - 10.*x.^3.*x2.*x8 - 10.*x.^3.*x4.*x6 - 10.*x.^3.*x4.*x7 - 10.*x.^3.*x5.*x6 - 10.*x.^3.*x4.*x8 - 10.*x.^3.*x5.*x7 - 10.*x.^3.*x5.*x8 - 10.*x.^3.*x6.*x7 - 10.*x.^3.*x6.*x8 - 10.*x.^3.*x7.*x8 + 6.*x.^2.*x1.*x2.*x4 + 6.*x.^2.*x1.*x2.*x5 + 6.*x.^2.*x1.*x2.*x6 + 6.*x.^2.*x1.*x2.*x7 + 6.*x.^2.*x1.*x4.*x5 + 6.*x.^2.*x1.*x2.*x8 + 6.*x.^2.*x1.*x4.*x6 + 6.*x.^2.*x2.*x4.*x5 + 6.*x.^2.*x1.*x4.*x7 + 6.*x.^2.*x1.*x5.*x6 + 6.*x.^2.*x2.*x4.*x6 + 6.*x.^2.*x1.*x4.*x8 + 6.*x.^2.*x1.*x5.*x7 + 6.*x.^2.*x2.*x4.*x7 + 6.*x.^2.*x2.*x5.*x6 + 6.*x.^2.*x1.*x5.*x8 + 6.*x.^2.*x1.*x6.*x7 + 6.*x.^2.*x2.*x4.*x8 + 6.*x.^2.*x2.*x5.*x7 + 6.*x.^2.*x1.*x6.*x8 + 6.*x.^2.*x2.*x5.*x8 + 6.*x.^2.*x2.*x6.*x7 + 6.*x.^2.*x4.*x5.*x6 + 6.*x.^2.*x1.*x7.*x8 + 6.*x.^2.*x2.*x6.*x8 + 6.*x.^2.*x4.*x5.*x7 + 6.*x.^2.*x2.*x7.*x8 + 6.*x.^2.*x4.*x5.*x8 + 6.*x.^2.*x4.*x6.*x7 + 6.*x.^2.*x4.*x6.*x8 + 6.*x.^2.*x5.*x6.*x7 + 6.*x.^2.*x4.*x7.*x8 + 6.*x.^2.*x5.*x6.*x8 + 6.*x.^2.*x5.*x7.*x8 + 6.*x.^2.*x6.*x7.*x8 - 3.*x.*x1.*x2.*x4.*x5 - 3.*x.*x1.*x2.*x4.*x6 - 3.*x.*x1.*x2.*x4.*x7 - 3.*x.*x1.*x2.*x5.*x6 - 3.*x.*x1.*x2.*x4.*x8 - 3.*x.*x1.*x2.*x5.*x7 - 3.*x.*x1.*x2.*x5.*x8 - 3.*x.*x1.*x2.*x6.*x7 - 3.*x.*x1.*x4.*x5.*x6 - 3.*x.*x1.*x2.*x6.*x8 - 3.*x.*x1.*x4.*x5.*x7 - 3.*x.*x2.*x4.*x5.*x6 - 3.*x.*x1.*x2.*x7.*x8 - 3.*x.*x1.*x4.*x5.*x8 - 3.*x.*x1.*x4.*x6.*x7 - 3.*x.*x2.*x4.*x5.*x7 + x1.*x2.*x4.*x5.*x6 - 3.*x.*x1.*x4.*x6.*x8 - 3.*x.*x1.*x5.*x6.*x7 - 3.*x.*x2.*x4.*x5.*x8 - 3.*x.*x2.*x4.*x6.*x7 + x1.*x2.*x4.*x5.*x7 - 3.*x.*x1.*x4.*x7.*x8 - 3.*x.*x1.*x5.*x6.*x8 - 3.*x.*x2.*x4.*x6.*x8 - 3.*x.*x2.*x5.*x6.*x7 + x1.*x2.*x4.*x5.*x8 + x1.*x2.*x4.*x6.*x7 - 3.*x.*x1.*x5.*x7.*x8 - 3.*x.*x2.*x4.*x7.*x8 - 3.*x.*x2.*x5.*x6.*x8 + x1.*x2.*x4.*x6.*x8 + x1.*x2.*x5.*x6.*x7 - 3.*x.*x1.*x6.*x7.*x8 - 3.*x.*x2.*x5.*x7.*x8 - 3.*x.*x4.*x5.*x6.*x7 + x1.*x2.*x4.*x7.*x8 + x1.*x2.*x5.*x6.*x8 - 3.*x.*x2.*x6.*x7.*x8 - 3.*x.*x4.*x5.*x6.*x8 + x1.*x2.*x5.*x7.*x8 + x1.*x4.*x5.*x6.*x7 - 3.*x.*x4.*x5.*x7.*x8 + x1.*x2.*x6.*x7.*x8 + x1.*x4.*x5.*x6.*x8 + x2.*x4.*x5.*x6.*x7 - 3.*x.*x4.*x6.*x7.*x8 + x1.*x4.*x5.*x7.*x8 + x2.*x4.*x5.*x6.*x8 - 3.*x.*x5.*x6.*x7.*x8 + x1.*x4.*x6.*x7.*x8 + x2.*x4.*x5.*x7.*x8 + x1.*x5.*x6.*x7.*x8 + x2.*x4.*x6.*x7.*x8 + x2.*x5.*x6.*x7.*x8 + x4.*x5.*x6.*x7.*x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                      (2.*(15.*x.^4.*x1 + 15.*x.^4.*x2 + 15.*x.^4.*x3 + 15.*x.^4.*x5 + 15.*x.^4.*x6 + 15.*x.^4.*x7 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x1.*x2 - 10.*x.^3.*x1.*x3 - 10.*x.^3.*x2.*x3 - 10.*x.^3.*x1.*x5 - 10.*x.^3.*x1.*x6 - 10.*x.^3.*x2.*x5 - 10.*x.^3.*x1.*x7 - 10.*x.^3.*x2.*x6 - 10.*x.^3.*x3.*x5 - 10.*x.^3.*x1.*x8 - 10.*x.^3.*x2.*x7 - 10.*x.^3.*x3.*x6 - 10.*x.^3.*x2.*x8 - 10.*x.^3.*x3.*x7 - 10.*x.^3.*x3.*x8 - 10.*x.^3.*x5.*x6 - 10.*x.^3.*x5.*x7 - 10.*x.^3.*x5.*x8 - 10.*x.^3.*x6.*x7 - 10.*x.^3.*x6.*x8 - 10.*x.^3.*x7.*x8 + 6.*x.^2.*x1.*x2.*x3 + 6.*x.^2.*x1.*x2.*x5 + 6.*x.^2.*x1.*x2.*x6 + 6.*x.^2.*x1.*x3.*x5 + 6.*x.^2.*x1.*x2.*x7 + 6.*x.^2.*x1.*x3.*x6 + 6.*x.^2.*x2.*x3.*x5 + 6.*x.^2.*x1.*x2.*x8 + 6.*x.^2.*x1.*x3.*x7 + 6.*x.^2.*x2.*x3.*x6 + 6.*x.^2.*x1.*x3.*x8 + 6.*x.^2.*x1.*x5.*x6 + 6.*x.^2.*x2.*x3.*x7 + 6.*x.^2.*x1.*x5.*x7 + 6.*x.^2.*x2.*x3.*x8 + 6.*x.^2.*x2.*x5.*x6 + 6.*x.^2.*x1.*x5.*x8 + 6.*x.^2.*x1.*x6.*x7 + 6.*x.^2.*x2.*x5.*x7 + 6.*x.^2.*x3.*x5.*x6 + 6.*x.^2.*x1.*x6.*x8 + 6.*x.^2.*x2.*x5.*x8 + 6.*x.^2.*x2.*x6.*x7 + 6.*x.^2.*x3.*x5.*x7 + 6.*x.^2.*x1.*x7.*x8 + 6.*x.^2.*x2.*x6.*x8 + 6.*x.^2.*x3.*x5.*x8 + 6.*x.^2.*x3.*x6.*x7 + 6.*x.^2.*x2.*x7.*x8 + 6.*x.^2.*x3.*x6.*x8 + 6.*x.^2.*x3.*x7.*x8 + 6.*x.^2.*x5.*x6.*x7 + 6.*x.^2.*x5.*x6.*x8 + 6.*x.^2.*x5.*x7.*x8 + 6.*x.^2.*x6.*x7.*x8 - 3.*x.*x1.*x2.*x3.*x5 - 3.*x.*x1.*x2.*x3.*x6 - 3.*x.*x1.*x2.*x3.*x7 - 3.*x.*x1.*x2.*x3.*x8 - 3.*x.*x1.*x2.*x5.*x6 - 3.*x.*x1.*x2.*x5.*x7 - 3.*x.*x1.*x3.*x5.*x6 - 3.*x.*x1.*x2.*x5.*x8 - 3.*x.*x1.*x2.*x6.*x7 - 3.*x.*x1.*x3.*x5.*x7 - 3.*x.*x2.*x3.*x5.*x6 - 3.*x.*x1.*x2.*x6.*x8 - 3.*x.*x1.*x3.*x5.*x8 - 3.*x.*x1.*x3.*x6.*x7 - 3.*x.*x2.*x3.*x5.*x7 + x1.*x2.*x3.*x5.*x6 - 3.*x.*x1.*x2.*x7.*x8 - 3.*x.*x1.*x3.*x6.*x8 - 3.*x.*x2.*x3.*x5.*x8 - 3.*x.*x2.*x3.*x6.*x7 + x1.*x2.*x3.*x5.*x7 - 3.*x.*x1.*x3.*x7.*x8 - 3.*x.*x1.*x5.*x6.*x7 - 3.*x.*x2.*x3.*x6.*x8 + x1.*x2.*x3.*x5.*x8 + x1.*x2.*x3.*x6.*x7 - 3.*x.*x1.*x5.*x6.*x8 - 3.*x.*x2.*x3.*x7.*x8 - 3.*x.*x2.*x5.*x6.*x7 + x1.*x2.*x3.*x6.*x8 - 3.*x.*x1.*x5.*x7.*x8 - 3.*x.*x2.*x5.*x6.*x8 - 3.*x.*x3.*x5.*x6.*x7 + x1.*x2.*x3.*x7.*x8 + x1.*x2.*x5.*x6.*x7 - 3.*x.*x1.*x6.*x7.*x8 - 3.*x.*x2.*x5.*x7.*x8 - 3.*x.*x3.*x5.*x6.*x8 + x1.*x2.*x5.*x6.*x8 + x1.*x3.*x5.*x6.*x7 - 3.*x.*x2.*x6.*x7.*x8 - 3.*x.*x3.*x5.*x7.*x8 + x1.*x2.*x5.*x7.*x8 + x1.*x3.*x5.*x6.*x8 + x2.*x3.*x5.*x6.*x7 - 3.*x.*x3.*x6.*x7.*x8 + x1.*x2.*x6.*x7.*x8 + x1.*x3.*x5.*x7.*x8 + x2.*x3.*x5.*x6.*x8 + x1.*x3.*x6.*x7.*x8 + x2.*x3.*x5.*x7.*x8 - 3.*x.*x5.*x6.*x7.*x8 + x2.*x3.*x6.*x7.*x8 + x1.*x5.*x6.*x7.*x8 + x2.*x5.*x6.*x7.*x8 + x3.*x5.*x6.*x7.*x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                     -(2.*(15.*x.^4.*x1 + 15.*x.^4.*x2 + 15.*x.^4.*x3 + 15.*x.^4.*x4 + 15.*x.^4.*x6 + 15.*x.^4.*x7 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x1.*x2 - 10.*x.^3.*x1.*x3 - 10.*x.^3.*x1.*x4 - 10.*x.^3.*x2.*x3 - 10.*x.^3.*x2.*x4 - 10.*x.^3.*x1.*x6 - 10.*x.^3.*x3.*x4 - 10.*x.^3.*x1.*x7 - 10.*x.^3.*x2.*x6 - 10.*x.^3.*x1.*x8 - 10.*x.^3.*x2.*x7 - 10.*x.^3.*x3.*x6 - 10.*x.^3.*x2.*x8 - 10.*x.^3.*x3.*x7 - 10.*x.^3.*x4.*x6 - 10.*x.^3.*x3.*x8 - 10.*x.^3.*x4.*x7 - 10.*x.^3.*x4.*x8 - 10.*x.^3.*x6.*x7 - 10.*x.^3.*x6.*x8 - 10.*x.^3.*x7.*x8 + 6.*x.^2.*x1.*x2.*x3 + 6.*x.^2.*x1.*x2.*x4 + 6.*x.^2.*x1.*x3.*x4 + 6.*x.^2.*x1.*x2.*x6 + 6.*x.^2.*x2.*x3.*x4 + 6.*x.^2.*x1.*x2.*x7 + 6.*x.^2.*x1.*x3.*x6 + 6.*x.^2.*x1.*x2.*x8 + 6.*x.^2.*x1.*x3.*x7 + 6.*x.^2.*x1.*x4.*x6 + 6.*x.^2.*x2.*x3.*x6 + 6.*x.^2.*x1.*x3.*x8 + 6.*x.^2.*x1.*x4.*x7 + 6.*x.^2.*x2.*x3.*x7 + 6.*x.^2.*x2.*x4.*x6 + 6.*x.^2.*x1.*x4.*x8 + 6.*x.^2.*x2.*x3.*x8 + 6.*x.^2.*x2.*x4.*x7 + 6.*x.^2.*x3.*x4.*x6 + 6.*x.^2.*x1.*x6.*x7 + 6.*x.^2.*x2.*x4.*x8 + 6.*x.^2.*x3.*x4.*x7 + 6.*x.^2.*x1.*x6.*x8 + 6.*x.^2.*x2.*x6.*x7 + 6.*x.^2.*x3.*x4.*x8 + 6.*x.^2.*x1.*x7.*x8 + 6.*x.^2.*x2.*x6.*x8 + 6.*x.^2.*x3.*x6.*x7 + 6.*x.^2.*x2.*x7.*x8 + 6.*x.^2.*x3.*x6.*x8 + 6.*x.^2.*x4.*x6.*x7 + 6.*x.^2.*x3.*x7.*x8 + 6.*x.^2.*x4.*x6.*x8 + 6.*x.^2.*x4.*x7.*x8 + 6.*x.^2.*x6.*x7.*x8 - 3.*x.*x1.*x2.*x3.*x4 - 3.*x.*x1.*x2.*x3.*x6 - 3.*x.*x1.*x2.*x3.*x7 - 3.*x.*x1.*x2.*x4.*x6 - 3.*x.*x1.*x2.*x3.*x8 - 3.*x.*x1.*x2.*x4.*x7 - 3.*x.*x1.*x3.*x4.*x6 - 3.*x.*x1.*x2.*x4.*x8 - 3.*x.*x1.*x3.*x4.*x7 - 3.*x.*x2.*x3.*x4.*x6 - 3.*x.*x1.*x2.*x6.*x7 - 3.*x.*x1.*x3.*x4.*x8 - 3.*x.*x2.*x3.*x4.*x7 + x1.*x2.*x3.*x4.*x6 - 3.*x.*x1.*x2.*x6.*x8 - 3.*x.*x1.*x3.*x6.*x7 - 3.*x.*x2.*x3.*x4.*x8 + x1.*x2.*x3.*x4.*x7 - 3.*x.*x1.*x2.*x7.*x8 - 3.*x.*x1.*x3.*x6.*x8 - 3.*x.*x1.*x4.*x6.*x7 - 3.*x.*x2.*x3.*x6.*x7 + x1.*x2.*x3.*x4.*x8 - 3.*x.*x1.*x3.*x7.*x8 - 3.*x.*x1.*x4.*x6.*x8 - 3.*x.*x2.*x3.*x6.*x8 - 3.*x.*x2.*x4.*x6.*x7 + x1.*x2.*x3.*x6.*x7 - 3.*x.*x1.*x4.*x7.*x8 - 3.*x.*x2.*x3.*x7.*x8 - 3.*x.*x2.*x4.*x6.*x8 - 3.*x.*x3.*x4.*x6.*x7 + x1.*x2.*x3.*x6.*x8 + x1.*x2.*x4.*x6.*x7 - 3.*x.*x2.*x4.*x7.*x8 - 3.*x.*x3.*x4.*x6.*x8 + x1.*x2.*x3.*x7.*x8 + x1.*x2.*x4.*x6.*x8 + x1.*x3.*x4.*x6.*x7 - 3.*x.*x1.*x6.*x7.*x8 - 3.*x.*x3.*x4.*x7.*x8 + x1.*x2.*x4.*x7.*x8 + x1.*x3.*x4.*x6.*x8 + x2.*x3.*x4.*x6.*x7 - 3.*x.*x2.*x6.*x7.*x8 + x1.*x3.*x4.*x7.*x8 + x2.*x3.*x4.*x6.*x8 - 3.*x.*x3.*x6.*x7.*x8 + x1.*x2.*x6.*x7.*x8 + x2.*x3.*x4.*x7.*x8 - 3.*x.*x4.*x6.*x7.*x8 + x1.*x3.*x6.*x7.*x8 + x1.*x4.*x6.*x7.*x8 + x2.*x3.*x6.*x7.*x8 + x2.*x4.*x6.*x7.*x8 + x3.*x4.*x6.*x7.*x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                      (2.*(15.*x.^4.*x1 + 15.*x.^4.*x2 + 15.*x.^4.*x3 + 15.*x.^4.*x4 + 15.*x.^4.*x5 + 15.*x.^4.*x7 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x1.*x2 - 10.*x.^3.*x1.*x3 - 10.*x.^3.*x1.*x4 - 10.*x.^3.*x2.*x3 - 10.*x.^3.*x1.*x5 - 10.*x.^3.*x2.*x4 - 10.*x.^3.*x2.*x5 - 10.*x.^3.*x3.*x4 - 10.*x.^3.*x1.*x7 - 10.*x.^3.*x3.*x5 - 10.*x.^3.*x1.*x8 - 10.*x.^3.*x2.*x7 - 10.*x.^3.*x4.*x5 - 10.*x.^3.*x2.*x8 - 10.*x.^3.*x3.*x7 - 10.*x.^3.*x3.*x8 - 10.*x.^3.*x4.*x7 - 10.*x.^3.*x4.*x8 - 10.*x.^3.*x5.*x7 - 10.*x.^3.*x5.*x8 - 10.*x.^3.*x7.*x8 + 6.*x.^2.*x1.*x2.*x3 + 6.*x.^2.*x1.*x2.*x4 + 6.*x.^2.*x1.*x2.*x5 + 6.*x.^2.*x1.*x3.*x4 + 6.*x.^2.*x1.*x3.*x5 + 6.*x.^2.*x2.*x3.*x4 + 6.*x.^2.*x1.*x2.*x7 + 6.*x.^2.*x1.*x4.*x5 + 6.*x.^2.*x2.*x3.*x5 + 6.*x.^2.*x1.*x2.*x8 + 6.*x.^2.*x1.*x3.*x7 + 6.*x.^2.*x2.*x4.*x5 + 6.*x.^2.*x1.*x3.*x8 + 6.*x.^2.*x1.*x4.*x7 + 6.*x.^2.*x2.*x3.*x7 + 6.*x.^2.*x3.*x4.*x5 + 6.*x.^2.*x1.*x4.*x8 + 6.*x.^2.*x1.*x5.*x7 + 6.*x.^2.*x2.*x3.*x8 + 6.*x.^2.*x2.*x4.*x7 + 6.*x.^2.*x1.*x5.*x8 + 6.*x.^2.*x2.*x4.*x8 + 6.*x.^2.*x2.*x5.*x7 + 6.*x.^2.*x3.*x4.*x7 + 6.*x.^2.*x2.*x5.*x8 + 6.*x.^2.*x3.*x4.*x8 + 6.*x.^2.*x3.*x5.*x7 + 6.*x.^2.*x1.*x7.*x8 + 6.*x.^2.*x3.*x5.*x8 + 6.*x.^2.*x4.*x5.*x7 + 6.*x.^2.*x2.*x7.*x8 + 6.*x.^2.*x4.*x5.*x8 + 6.*x.^2.*x3.*x7.*x8 + 6.*x.^2.*x4.*x7.*x8 + 6.*x.^2.*x5.*x7.*x8 - 3.*x.*x1.*x2.*x3.*x4 - 3.*x.*x1.*x2.*x3.*x5 - 3.*x.*x1.*x2.*x4.*x5 - 3.*x.*x1.*x2.*x3.*x7 - 3.*x.*x1.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x3.*x8 - 3.*x.*x1.*x2.*x4.*x7 - 3.*x.*x2.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x4.*x8 - 3.*x.*x1.*x2.*x5.*x7 - 3.*x.*x1.*x3.*x4.*x7 + x1.*x2.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x5.*x8 - 3.*x.*x1.*x3.*x4.*x8 - 3.*x.*x1.*x3.*x5.*x7 - 3.*x.*x2.*x3.*x4.*x7 - 3.*x.*x1.*x3.*x5.*x8 - 3.*x.*x1.*x4.*x5.*x7 - 3.*x.*x2.*x3.*x4.*x8 - 3.*x.*x2.*x3.*x5.*x7 + x1.*x2.*x3.*x4.*x7 - 3.*x.*x1.*x2.*x7.*x8 - 3.*x.*x1.*x4.*x5.*x8 - 3.*x.*x2.*x3.*x5.*x8 - 3.*x.*x2.*x4.*x5.*x7 + x1.*x2.*x3.*x4.*x8 + x1.*x2.*x3.*x5.*x7 - 3.*x.*x1.*x3.*x7.*x8 - 3.*x.*x2.*x4.*x5.*x8 - 3.*x.*x3.*x4.*x5.*x7 + x1.*x2.*x3.*x5.*x8 + x1.*x2.*x4.*x5.*x7 - 3.*x.*x1.*x4.*x7.*x8 - 3.*x.*x2.*x3.*x7.*x8 - 3.*x.*x3.*x4.*x5.*x8 + x1.*x2.*x4.*x5.*x8 + x1.*x3.*x4.*x5.*x7 - 3.*x.*x1.*x5.*x7.*x8 - 3.*x.*x2.*x4.*x7.*x8 + x1.*x2.*x3.*x7.*x8 + x1.*x3.*x4.*x5.*x8 + x2.*x3.*x4.*x5.*x7 - 3.*x.*x2.*x5.*x7.*x8 - 3.*x.*x3.*x4.*x7.*x8 + x1.*x2.*x4.*x7.*x8 + x2.*x3.*x4.*x5.*x8 - 3.*x.*x3.*x5.*x7.*x8 + x1.*x2.*x5.*x7.*x8 + x1.*x3.*x4.*x7.*x8 - 3.*x.*x4.*x5.*x7.*x8 + x1.*x3.*x5.*x7.*x8 + x2.*x3.*x4.*x7.*x8 + x1.*x4.*x5.*x7.*x8 + x2.*x3.*x5.*x7.*x8 + x2.*x4.*x5.*x7.*x8 + x3.*x4.*x5.*x7.*x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                     -(2.*(15.*x.^4.*x1 + 15.*x.^4.*x2 + 15.*x.^4.*x3 + 15.*x.^4.*x4 + 15.*x.^4.*x5 + 15.*x.^4.*x6 + 15.*x.^4.*x8 - 21.*x.^5 - 10.*x.^3.*x1.*x2 - 10.*x.^3.*x1.*x3 - 10.*x.^3.*x1.*x4 - 10.*x.^3.*x2.*x3 - 10.*x.^3.*x1.*x5 - 10.*x.^3.*x2.*x4 - 10.*x.^3.*x1.*x6 - 10.*x.^3.*x2.*x5 - 10.*x.^3.*x3.*x4 - 10.*x.^3.*x2.*x6 - 10.*x.^3.*x3.*x5 - 10.*x.^3.*x1.*x8 - 10.*x.^3.*x3.*x6 - 10.*x.^3.*x4.*x5 - 10.*x.^3.*x2.*x8 - 10.*x.^3.*x4.*x6 - 10.*x.^3.*x3.*x8 - 10.*x.^3.*x5.*x6 - 10.*x.^3.*x4.*x8 - 10.*x.^3.*x5.*x8 - 10.*x.^3.*x6.*x8 + 6.*x.^2.*x1.*x2.*x3 + 6.*x.^2.*x1.*x2.*x4 + 6.*x.^2.*x1.*x2.*x5 + 6.*x.^2.*x1.*x3.*x4 + 6.*x.^2.*x1.*x2.*x6 + 6.*x.^2.*x1.*x3.*x5 + 6.*x.^2.*x2.*x3.*x4 + 6.*x.^2.*x1.*x3.*x6 + 6.*x.^2.*x1.*x4.*x5 + 6.*x.^2.*x2.*x3.*x5 + 6.*x.^2.*x1.*x2.*x8 + 6.*x.^2.*x1.*x4.*x6 + 6.*x.^2.*x2.*x3.*x6 + 6.*x.^2.*x2.*x4.*x5 + 6.*x.^2.*x1.*x3.*x8 + 6.*x.^2.*x1.*x5.*x6 + 6.*x.^2.*x2.*x4.*x6 + 6.*x.^2.*x3.*x4.*x5 + 6.*x.^2.*x1.*x4.*x8 + 6.*x.^2.*x2.*x3.*x8 + 6.*x.^2.*x2.*x5.*x6 + 6.*x.^2.*x3.*x4.*x6 + 6.*x.^2.*x1.*x5.*x8 + 6.*x.^2.*x2.*x4.*x8 + 6.*x.^2.*x3.*x5.*x6 + 6.*x.^2.*x1.*x6.*x8 + 6.*x.^2.*x2.*x5.*x8 + 6.*x.^2.*x3.*x4.*x8 + 6.*x.^2.*x4.*x5.*x6 + 6.*x.^2.*x2.*x6.*x8 + 6.*x.^2.*x3.*x5.*x8 + 6.*x.^2.*x3.*x6.*x8 + 6.*x.^2.*x4.*x5.*x8 + 6.*x.^2.*x4.*x6.*x8 + 6.*x.^2.*x5.*x6.*x8 - 3.*x.*x1.*x2.*x3.*x4 - 3.*x.*x1.*x2.*x3.*x5 - 3.*x.*x1.*x2.*x3.*x6 - 3.*x.*x1.*x2.*x4.*x5 - 3.*x.*x1.*x2.*x4.*x6 - 3.*x.*x1.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x3.*x8 - 3.*x.*x1.*x2.*x5.*x6 - 3.*x.*x1.*x3.*x4.*x6 - 3.*x.*x2.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x4.*x8 - 3.*x.*x1.*x3.*x5.*x6 - 3.*x.*x2.*x3.*x4.*x6 + x1.*x2.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x5.*x8 - 3.*x.*x1.*x3.*x4.*x8 - 3.*x.*x1.*x4.*x5.*x6 - 3.*x.*x2.*x3.*x5.*x6 + x1.*x2.*x3.*x4.*x6 - 3.*x.*x1.*x2.*x6.*x8 - 3.*x.*x1.*x3.*x5.*x8 - 3.*x.*x2.*x3.*x4.*x8 - 3.*x.*x2.*x4.*x5.*x6 + x1.*x2.*x3.*x5.*x6 - 3.*x.*x1.*x3.*x6.*x8 - 3.*x.*x1.*x4.*x5.*x8 - 3.*x.*x2.*x3.*x5.*x8 - 3.*x.*x3.*x4.*x5.*x6 + x1.*x2.*x3.*x4.*x8 + x1.*x2.*x4.*x5.*x6 - 3.*x.*x1.*x4.*x6.*x8 - 3.*x.*x2.*x3.*x6.*x8 - 3.*x.*x2.*x4.*x5.*x8 + x1.*x2.*x3.*x5.*x8 + x1.*x3.*x4.*x5.*x6 - 3.*x.*x1.*x5.*x6.*x8 - 3.*x.*x2.*x4.*x6.*x8 - 3.*x.*x3.*x4.*x5.*x8 + x1.*x2.*x3.*x6.*x8 + x1.*x2.*x4.*x5.*x8 + x2.*x3.*x4.*x5.*x6 - 3.*x.*x2.*x5.*x6.*x8 - 3.*x.*x3.*x4.*x6.*x8 + x1.*x2.*x4.*x6.*x8 + x1.*x3.*x4.*x5.*x8 - 3.*x.*x3.*x5.*x6.*x8 + x1.*x2.*x5.*x6.*x8 + x1.*x3.*x4.*x6.*x8 + x2.*x3.*x4.*x5.*x8 - 3.*x.*x4.*x5.*x6.*x8 + x1.*x3.*x5.*x6.*x8 + x2.*x3.*x4.*x6.*x8 + x1.*x4.*x5.*x6.*x8 + x2.*x3.*x5.*x6.*x8 + x2.*x4.*x5.*x6.*x8 + x3.*x4.*x5.*x6.*x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                      (2.*(15.*x.^4.*x1 + 15.*x.^4.*x2 + 15.*x.^4.*x3 + 15.*x.^4.*x4 + 15.*x.^4.*x5 + 15.*x.^4.*x6 + 15.*x.^4.*x7 - 21.*x.^5 - 10.*x.^3.*x1.*x2 - 10.*x.^3.*x1.*x3 - 10.*x.^3.*x1.*x4 - 10.*x.^3.*x2.*x3 - 10.*x.^3.*x1.*x5 - 10.*x.^3.*x2.*x4 - 10.*x.^3.*x1.*x6 - 10.*x.^3.*x2.*x5 - 10.*x.^3.*x3.*x4 - 10.*x.^3.*x1.*x7 - 10.*x.^3.*x2.*x6 - 10.*x.^3.*x3.*x5 - 10.*x.^3.*x2.*x7 - 10.*x.^3.*x3.*x6 - 10.*x.^3.*x4.*x5 - 10.*x.^3.*x3.*x7 - 10.*x.^3.*x4.*x6 - 10.*x.^3.*x4.*x7 - 10.*x.^3.*x5.*x6 - 10.*x.^3.*x5.*x7 - 10.*x.^3.*x6.*x7 + 6.*x.^2.*x1.*x2.*x3 + 6.*x.^2.*x1.*x2.*x4 + 6.*x.^2.*x1.*x2.*x5 + 6.*x.^2.*x1.*x3.*x4 + 6.*x.^2.*x1.*x2.*x6 + 6.*x.^2.*x1.*x3.*x5 + 6.*x.^2.*x2.*x3.*x4 + 6.*x.^2.*x1.*x2.*x7 + 6.*x.^2.*x1.*x3.*x6 + 6.*x.^2.*x1.*x4.*x5 + 6.*x.^2.*x2.*x3.*x5 + 6.*x.^2.*x1.*x3.*x7 + 6.*x.^2.*x1.*x4.*x6 + 6.*x.^2.*x2.*x3.*x6 + 6.*x.^2.*x2.*x4.*x5 + 6.*x.^2.*x1.*x4.*x7 + 6.*x.^2.*x1.*x5.*x6 + 6.*x.^2.*x2.*x3.*x7 + 6.*x.^2.*x2.*x4.*x6 + 6.*x.^2.*x3.*x4.*x5 + 6.*x.^2.*x1.*x5.*x7 + 6.*x.^2.*x2.*x4.*x7 + 6.*x.^2.*x2.*x5.*x6 + 6.*x.^2.*x3.*x4.*x6 + 6.*x.^2.*x1.*x6.*x7 + 6.*x.^2.*x2.*x5.*x7 + 6.*x.^2.*x3.*x4.*x7 + 6.*x.^2.*x3.*x5.*x6 + 6.*x.^2.*x2.*x6.*x7 + 6.*x.^2.*x3.*x5.*x7 + 6.*x.^2.*x4.*x5.*x6 + 6.*x.^2.*x3.*x6.*x7 + 6.*x.^2.*x4.*x5.*x7 + 6.*x.^2.*x4.*x6.*x7 + 6.*x.^2.*x5.*x6.*x7 - 3.*x.*x1.*x2.*x3.*x4 - 3.*x.*x1.*x2.*x3.*x5 - 3.*x.*x1.*x2.*x3.*x6 - 3.*x.*x1.*x2.*x4.*x5 - 3.*x.*x1.*x2.*x3.*x7 - 3.*x.*x1.*x2.*x4.*x6 - 3.*x.*x1.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x4.*x7 - 3.*x.*x1.*x2.*x5.*x6 - 3.*x.*x1.*x3.*x4.*x6 - 3.*x.*x2.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x5.*x7 - 3.*x.*x1.*x3.*x4.*x7 - 3.*x.*x1.*x3.*x5.*x6 - 3.*x.*x2.*x3.*x4.*x6 + x1.*x2.*x3.*x4.*x5 - 3.*x.*x1.*x2.*x6.*x7 - 3.*x.*x1.*x3.*x5.*x7 - 3.*x.*x1.*x4.*x5.*x6 - 3.*x.*x2.*x3.*x4.*x7 - 3.*x.*x2.*x3.*x5.*x6 + x1.*x2.*x3.*x4.*x6 - 3.*x.*x1.*x3.*x6.*x7 - 3.*x.*x1.*x4.*x5.*x7 - 3.*x.*x2.*x3.*x5.*x7 - 3.*x.*x2.*x4.*x5.*x6 + x1.*x2.*x3.*x4.*x7 + x1.*x2.*x3.*x5.*x6 - 3.*x.*x1.*x4.*x6.*x7 - 3.*x.*x2.*x3.*x6.*x7 - 3.*x.*x2.*x4.*x5.*x7 - 3.*x.*x3.*x4.*x5.*x6 + x1.*x2.*x3.*x5.*x7 + x1.*x2.*x4.*x5.*x6 - 3.*x.*x1.*x5.*x6.*x7 - 3.*x.*x2.*x4.*x6.*x7 - 3.*x.*x3.*x4.*x5.*x7 + x1.*x2.*x3.*x6.*x7 + x1.*x2.*x4.*x5.*x7 + x1.*x3.*x4.*x5.*x6 - 3.*x.*x2.*x5.*x6.*x7 - 3.*x.*x3.*x4.*x6.*x7 + x1.*x2.*x4.*x6.*x7 + x1.*x3.*x4.*x5.*x7 + x2.*x3.*x4.*x5.*x6 - 3.*x.*x3.*x5.*x6.*x7 + x1.*x2.*x5.*x6.*x7 + x1.*x3.*x4.*x6.*x7 + x2.*x3.*x4.*x5.*x7 - 3.*x.*x4.*x5.*x6.*x7 + x1.*x3.*x5.*x6.*x7 + x2.*x3.*x4.*x6.*x7 + x1.*x4.*x5.*x6.*x7 + x2.*x3.*x5.*x6.*x7 + x2.*x4.*x5.*x6.*x7 + x3.*x4.*x5.*x6.*x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 3
                dnL=[(2.*(105.*x.^4 - 60.*x.^3.*x3 - 60.*x.^3.*x4 - 60.*x.^3.*x5 - 60.*x.^3.*x6 - 60.*x.^3.*x7 - 60.*x.^3.*x8 - 60.*x.^3.*x2 + 30.*x.^2.*x2.*x3 + 30.*x.^2.*x2.*x4 + 30.*x.^2.*x2.*x5 + 30.*x.^2.*x3.*x4 + 30.*x.^2.*x2.*x6 + 30.*x.^2.*x3.*x5 + 30.*x.^2.*x2.*x7 + 30.*x.^2.*x3.*x6 + 30.*x.^2.*x4.*x5 + 30.*x.^2.*x2.*x8 + 30.*x.^2.*x3.*x7 + 30.*x.^2.*x4.*x6 + 30.*x.^2.*x3.*x8 + 30.*x.^2.*x4.*x7 + 30.*x.^2.*x5.*x6 + 30.*x.^2.*x4.*x8 + 30.*x.^2.*x5.*x7 + 30.*x.^2.*x5.*x8 + 30.*x.^2.*x6.*x7 + 30.*x.^2.*x6.*x8 + 30.*x.^2.*x7.*x8 - 12.*x.*x2.*x3.*x4 - 12.*x.*x2.*x3.*x5 - 12.*x.*x2.*x3.*x6 - 12.*x.*x2.*x4.*x5 - 12.*x.*x2.*x3.*x7 - 12.*x.*x2.*x4.*x6 - 12.*x.*x3.*x4.*x5 - 12.*x.*x2.*x3.*x8 - 12.*x.*x2.*x4.*x7 - 12.*x.*x2.*x5.*x6 - 12.*x.*x3.*x4.*x6 - 12.*x.*x2.*x4.*x8 - 12.*x.*x2.*x5.*x7 - 12.*x.*x3.*x4.*x7 - 12.*x.*x3.*x5.*x6 + 3.*x2.*x3.*x4.*x5 - 12.*x.*x2.*x5.*x8 - 12.*x.*x2.*x6.*x7 - 12.*x.*x3.*x4.*x8 - 12.*x.*x3.*x5.*x7 - 12.*x.*x4.*x5.*x6 + 3.*x2.*x3.*x4.*x6 - 12.*x.*x2.*x6.*x8 - 12.*x.*x3.*x5.*x8 - 12.*x.*x3.*x6.*x7 - 12.*x.*x4.*x5.*x7 + 3.*x2.*x3.*x4.*x7 + 3.*x2.*x3.*x5.*x6 - 12.*x.*x2.*x7.*x8 - 12.*x.*x3.*x6.*x8 - 12.*x.*x4.*x5.*x8 - 12.*x.*x4.*x6.*x7 + 3.*x2.*x3.*x4.*x8 + 3.*x2.*x3.*x5.*x7 + 3.*x2.*x4.*x5.*x6 - 12.*x.*x3.*x7.*x8 - 12.*x.*x4.*x6.*x8 - 12.*x.*x5.*x6.*x7 + 3.*x2.*x3.*x5.*x8 + 3.*x2.*x3.*x6.*x7 + 3.*x2.*x4.*x5.*x7 + 3.*x3.*x4.*x5.*x6 - 12.*x.*x4.*x7.*x8 - 12.*x.*x5.*x6.*x8 + 3.*x2.*x3.*x6.*x8 + 3.*x2.*x4.*x5.*x8 + 3.*x2.*x4.*x6.*x7 + 3.*x3.*x4.*x5.*x7 - 12.*x.*x5.*x7.*x8 + 3.*x2.*x3.*x7.*x8 + 3.*x2.*x4.*x6.*x8 + 3.*x2.*x5.*x6.*x7 + 3.*x3.*x4.*x5.*x8 + 3.*x3.*x4.*x6.*x7 - 12.*x.*x6.*x7.*x8 + 3.*x2.*x4.*x7.*x8 + 3.*x2.*x5.*x6.*x8 + 3.*x3.*x4.*x6.*x8 + 3.*x3.*x5.*x6.*x7 + 3.*x2.*x5.*x7.*x8 + 3.*x3.*x4.*x7.*x8 + 3.*x3.*x5.*x6.*x8 + 3.*x4.*x5.*x6.*x7 + 3.*x2.*x6.*x7.*x8 + 3.*x3.*x5.*x7.*x8 + 3.*x4.*x5.*x6.*x8 + 3.*x3.*x6.*x7.*x8 + 3.*x4.*x5.*x7.*x8 + 3.*x4.*x6.*x7.*x8 + 3.*x5.*x6.*x7.*x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                         -(2.*(105.*x.^4 - 60.*x.^3.*x3 - 60.*x.^3.*x4 - 60.*x.^3.*x5 - 60.*x.^3.*x6 - 60.*x.^3.*x7 - 60.*x.^3.*x8 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x3 + 30.*x.^2.*x1.*x4 + 30.*x.^2.*x1.*x5 + 30.*x.^2.*x1.*x6 + 30.*x.^2.*x3.*x4 + 30.*x.^2.*x1.*x7 + 30.*x.^2.*x3.*x5 + 30.*x.^2.*x1.*x8 + 30.*x.^2.*x3.*x6 + 30.*x.^2.*x4.*x5 + 30.*x.^2.*x3.*x7 + 30.*x.^2.*x4.*x6 + 30.*x.^2.*x3.*x8 + 30.*x.^2.*x4.*x7 + 30.*x.^2.*x5.*x6 + 30.*x.^2.*x4.*x8 + 30.*x.^2.*x5.*x7 + 30.*x.^2.*x5.*x8 + 30.*x.^2.*x6.*x7 + 30.*x.^2.*x6.*x8 + 30.*x.^2.*x7.*x8 - 12.*x.*x1.*x3.*x4 - 12.*x.*x1.*x3.*x5 - 12.*x.*x1.*x3.*x6 - 12.*x.*x1.*x4.*x5 - 12.*x.*x1.*x3.*x7 - 12.*x.*x1.*x4.*x6 - 12.*x.*x1.*x3.*x8 - 12.*x.*x1.*x4.*x7 - 12.*x.*x1.*x5.*x6 - 12.*x.*x3.*x4.*x5 - 12.*x.*x1.*x4.*x8 - 12.*x.*x1.*x5.*x7 - 12.*x.*x3.*x4.*x6 + 3.*x1.*x3.*x4.*x5 - 12.*x.*x1.*x5.*x8 - 12.*x.*x1.*x6.*x7 - 12.*x.*x3.*x4.*x7 - 12.*x.*x3.*x5.*x6 + 3.*x1.*x3.*x4.*x6 - 12.*x.*x1.*x6.*x8 - 12.*x.*x3.*x4.*x8 - 12.*x.*x3.*x5.*x7 - 12.*x.*x4.*x5.*x6 + 3.*x1.*x3.*x4.*x7 + 3.*x1.*x3.*x5.*x6 - 12.*x.*x1.*x7.*x8 - 12.*x.*x3.*x5.*x8 - 12.*x.*x3.*x6.*x7 - 12.*x.*x4.*x5.*x7 + 3.*x1.*x3.*x4.*x8 + 3.*x1.*x3.*x5.*x7 + 3.*x1.*x4.*x5.*x6 - 12.*x.*x3.*x6.*x8 - 12.*x.*x4.*x5.*x8 - 12.*x.*x4.*x6.*x7 + 3.*x1.*x3.*x5.*x8 + 3.*x1.*x3.*x6.*x7 + 3.*x1.*x4.*x5.*x7 - 12.*x.*x3.*x7.*x8 - 12.*x.*x4.*x6.*x8 - 12.*x.*x5.*x6.*x7 + 3.*x1.*x3.*x6.*x8 + 3.*x1.*x4.*x5.*x8 + 3.*x1.*x4.*x6.*x7 + 3.*x3.*x4.*x5.*x6 - 12.*x.*x4.*x7.*x8 - 12.*x.*x5.*x6.*x8 + 3.*x1.*x3.*x7.*x8 + 3.*x1.*x4.*x6.*x8 + 3.*x1.*x5.*x6.*x7 + 3.*x3.*x4.*x5.*x7 - 12.*x.*x5.*x7.*x8 + 3.*x1.*x4.*x7.*x8 + 3.*x1.*x5.*x6.*x8 + 3.*x3.*x4.*x5.*x8 + 3.*x3.*x4.*x6.*x7 - 12.*x.*x6.*x7.*x8 + 3.*x1.*x5.*x7.*x8 + 3.*x3.*x4.*x6.*x8 + 3.*x3.*x5.*x6.*x7 + 3.*x1.*x6.*x7.*x8 + 3.*x3.*x4.*x7.*x8 + 3.*x3.*x5.*x6.*x8 + 3.*x4.*x5.*x6.*x7 + 3.*x3.*x5.*x7.*x8 + 3.*x4.*x5.*x6.*x8 + 3.*x3.*x6.*x7.*x8 + 3.*x4.*x5.*x7.*x8 + 3.*x4.*x6.*x7.*x8 + 3.*x5.*x6.*x7.*x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                          (2.*(105.*x.^4 - 60.*x.^3.*x2 - 60.*x.^3.*x4 - 60.*x.^3.*x5 - 60.*x.^3.*x6 - 60.*x.^3.*x7 - 60.*x.^3.*x8 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x2 + 30.*x.^2.*x1.*x4 + 30.*x.^2.*x1.*x5 + 30.*x.^2.*x2.*x4 + 30.*x.^2.*x1.*x6 + 30.*x.^2.*x2.*x5 + 30.*x.^2.*x1.*x7 + 30.*x.^2.*x2.*x6 + 30.*x.^2.*x1.*x8 + 30.*x.^2.*x2.*x7 + 30.*x.^2.*x4.*x5 + 30.*x.^2.*x2.*x8 + 30.*x.^2.*x4.*x6 + 30.*x.^2.*x4.*x7 + 30.*x.^2.*x5.*x6 + 30.*x.^2.*x4.*x8 + 30.*x.^2.*x5.*x7 + 30.*x.^2.*x5.*x8 + 30.*x.^2.*x6.*x7 + 30.*x.^2.*x6.*x8 + 30.*x.^2.*x7.*x8 - 12.*x.*x1.*x2.*x4 - 12.*x.*x1.*x2.*x5 - 12.*x.*x1.*x2.*x6 - 12.*x.*x1.*x2.*x7 - 12.*x.*x1.*x4.*x5 - 12.*x.*x1.*x2.*x8 - 12.*x.*x1.*x4.*x6 - 12.*x.*x2.*x4.*x5 - 12.*x.*x1.*x4.*x7 - 12.*x.*x1.*x5.*x6 - 12.*x.*x2.*x4.*x6 + 3.*x1.*x2.*x4.*x5 - 12.*x.*x1.*x4.*x8 - 12.*x.*x1.*x5.*x7 - 12.*x.*x2.*x4.*x7 - 12.*x.*x2.*x5.*x6 + 3.*x1.*x2.*x4.*x6 - 12.*x.*x1.*x5.*x8 - 12.*x.*x1.*x6.*x7 - 12.*x.*x2.*x4.*x8 - 12.*x.*x2.*x5.*x7 + 3.*x1.*x2.*x4.*x7 + 3.*x1.*x2.*x5.*x6 - 12.*x.*x1.*x6.*x8 - 12.*x.*x2.*x5.*x8 - 12.*x.*x2.*x6.*x7 - 12.*x.*x4.*x5.*x6 + 3.*x1.*x2.*x4.*x8 + 3.*x1.*x2.*x5.*x7 - 12.*x.*x1.*x7.*x8 - 12.*x.*x2.*x6.*x8 - 12.*x.*x4.*x5.*x7 + 3.*x1.*x2.*x5.*x8 + 3.*x1.*x2.*x6.*x7 + 3.*x1.*x4.*x5.*x6 - 12.*x.*x2.*x7.*x8 - 12.*x.*x4.*x5.*x8 - 12.*x.*x4.*x6.*x7 + 3.*x1.*x2.*x6.*x8 + 3.*x1.*x4.*x5.*x7 + 3.*x2.*x4.*x5.*x6 - 12.*x.*x4.*x6.*x8 - 12.*x.*x5.*x6.*x7 + 3.*x1.*x2.*x7.*x8 + 3.*x1.*x4.*x5.*x8 + 3.*x1.*x4.*x6.*x7 + 3.*x2.*x4.*x5.*x7 - 12.*x.*x4.*x7.*x8 - 12.*x.*x5.*x6.*x8 + 3.*x1.*x4.*x6.*x8 + 3.*x1.*x5.*x6.*x7 + 3.*x2.*x4.*x5.*x8 + 3.*x2.*x4.*x6.*x7 - 12.*x.*x5.*x7.*x8 + 3.*x1.*x4.*x7.*x8 + 3.*x1.*x5.*x6.*x8 + 3.*x2.*x4.*x6.*x8 + 3.*x2.*x5.*x6.*x7 - 12.*x.*x6.*x7.*x8 + 3.*x1.*x5.*x7.*x8 + 3.*x2.*x4.*x7.*x8 + 3.*x2.*x5.*x6.*x8 + 3.*x1.*x6.*x7.*x8 + 3.*x2.*x5.*x7.*x8 + 3.*x4.*x5.*x6.*x7 + 3.*x2.*x6.*x7.*x8 + 3.*x4.*x5.*x6.*x8 + 3.*x4.*x5.*x7.*x8 + 3.*x4.*x6.*x7.*x8 + 3.*x5.*x6.*x7.*x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                         -(2.*(105.*x.^4 - 60.*x.^3.*x2 - 60.*x.^3.*x3 - 60.*x.^3.*x5 - 60.*x.^3.*x6 - 60.*x.^3.*x7 - 60.*x.^3.*x8 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x2 + 30.*x.^2.*x1.*x3 + 30.*x.^2.*x2.*x3 + 30.*x.^2.*x1.*x5 + 30.*x.^2.*x1.*x6 + 30.*x.^2.*x2.*x5 + 30.*x.^2.*x1.*x7 + 30.*x.^2.*x2.*x6 + 30.*x.^2.*x3.*x5 + 30.*x.^2.*x1.*x8 + 30.*x.^2.*x2.*x7 + 30.*x.^2.*x3.*x6 + 30.*x.^2.*x2.*x8 + 30.*x.^2.*x3.*x7 + 30.*x.^2.*x3.*x8 + 30.*x.^2.*x5.*x6 + 30.*x.^2.*x5.*x7 + 30.*x.^2.*x5.*x8 + 30.*x.^2.*x6.*x7 + 30.*x.^2.*x6.*x8 + 30.*x.^2.*x7.*x8 - 12.*x.*x1.*x2.*x3 - 12.*x.*x1.*x2.*x5 - 12.*x.*x1.*x2.*x6 - 12.*x.*x1.*x3.*x5 - 12.*x.*x1.*x2.*x7 - 12.*x.*x1.*x3.*x6 - 12.*x.*x2.*x3.*x5 - 12.*x.*x1.*x2.*x8 - 12.*x.*x1.*x3.*x7 - 12.*x.*x2.*x3.*x6 + 3.*x1.*x2.*x3.*x5 - 12.*x.*x1.*x3.*x8 - 12.*x.*x1.*x5.*x6 - 12.*x.*x2.*x3.*x7 + 3.*x1.*x2.*x3.*x6 - 12.*x.*x1.*x5.*x7 - 12.*x.*x2.*x3.*x8 - 12.*x.*x2.*x5.*x6 + 3.*x1.*x2.*x3.*x7 - 12.*x.*x1.*x5.*x8 - 12.*x.*x1.*x6.*x7 - 12.*x.*x2.*x5.*x7 - 12.*x.*x3.*x5.*x6 + 3.*x1.*x2.*x3.*x8 + 3.*x1.*x2.*x5.*x6 - 12.*x.*x1.*x6.*x8 - 12.*x.*x2.*x5.*x8 - 12.*x.*x2.*x6.*x7 - 12.*x.*x3.*x5.*x7 + 3.*x1.*x2.*x5.*x7 + 3.*x1.*x3.*x5.*x6 - 12.*x.*x1.*x7.*x8 - 12.*x.*x2.*x6.*x8 - 12.*x.*x3.*x5.*x8 - 12.*x.*x3.*x6.*x7 + 3.*x1.*x2.*x5.*x8 + 3.*x1.*x2.*x6.*x7 + 3.*x1.*x3.*x5.*x7 + 3.*x2.*x3.*x5.*x6 - 12.*x.*x2.*x7.*x8 - 12.*x.*x3.*x6.*x8 + 3.*x1.*x2.*x6.*x8 + 3.*x1.*x3.*x5.*x8 + 3.*x1.*x3.*x6.*x7 + 3.*x2.*x3.*x5.*x7 - 12.*x.*x3.*x7.*x8 - 12.*x.*x5.*x6.*x7 + 3.*x1.*x2.*x7.*x8 + 3.*x1.*x3.*x6.*x8 + 3.*x2.*x3.*x5.*x8 + 3.*x2.*x3.*x6.*x7 - 12.*x.*x5.*x6.*x8 + 3.*x1.*x3.*x7.*x8 + 3.*x1.*x5.*x6.*x7 + 3.*x2.*x3.*x6.*x8 - 12.*x.*x5.*x7.*x8 + 3.*x1.*x5.*x6.*x8 + 3.*x2.*x3.*x7.*x8 + 3.*x2.*x5.*x6.*x7 - 12.*x.*x6.*x7.*x8 + 3.*x1.*x5.*x7.*x8 + 3.*x2.*x5.*x6.*x8 + 3.*x3.*x5.*x6.*x7 + 3.*x1.*x6.*x7.*x8 + 3.*x2.*x5.*x7.*x8 + 3.*x3.*x5.*x6.*x8 + 3.*x2.*x6.*x7.*x8 + 3.*x3.*x5.*x7.*x8 + 3.*x3.*x6.*x7.*x8 + 3.*x5.*x6.*x7.*x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                          (2.*(105.*x.^4 - 60.*x.^3.*x2 - 60.*x.^3.*x3 - 60.*x.^3.*x4 - 60.*x.^3.*x6 - 60.*x.^3.*x7 - 60.*x.^3.*x8 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x2 + 30.*x.^2.*x1.*x3 + 30.*x.^2.*x1.*x4 + 30.*x.^2.*x2.*x3 + 30.*x.^2.*x2.*x4 + 30.*x.^2.*x1.*x6 + 30.*x.^2.*x3.*x4 + 30.*x.^2.*x1.*x7 + 30.*x.^2.*x2.*x6 + 30.*x.^2.*x1.*x8 + 30.*x.^2.*x2.*x7 + 30.*x.^2.*x3.*x6 + 30.*x.^2.*x2.*x8 + 30.*x.^2.*x3.*x7 + 30.*x.^2.*x4.*x6 + 30.*x.^2.*x3.*x8 + 30.*x.^2.*x4.*x7 + 30.*x.^2.*x4.*x8 + 30.*x.^2.*x6.*x7 + 30.*x.^2.*x6.*x8 + 30.*x.^2.*x7.*x8 - 12.*x.*x1.*x2.*x3 - 12.*x.*x1.*x2.*x4 - 12.*x.*x1.*x3.*x4 - 12.*x.*x1.*x2.*x6 - 12.*x.*x2.*x3.*x4 - 12.*x.*x1.*x2.*x7 - 12.*x.*x1.*x3.*x6 + 3.*x1.*x2.*x3.*x4 - 12.*x.*x1.*x2.*x8 - 12.*x.*x1.*x3.*x7 - 12.*x.*x1.*x4.*x6 - 12.*x.*x2.*x3.*x6 - 12.*x.*x1.*x3.*x8 - 12.*x.*x1.*x4.*x7 - 12.*x.*x2.*x3.*x7 - 12.*x.*x2.*x4.*x6 + 3.*x1.*x2.*x3.*x6 - 12.*x.*x1.*x4.*x8 - 12.*x.*x2.*x3.*x8 - 12.*x.*x2.*x4.*x7 - 12.*x.*x3.*x4.*x6 + 3.*x1.*x2.*x3.*x7 + 3.*x1.*x2.*x4.*x6 - 12.*x.*x1.*x6.*x7 - 12.*x.*x2.*x4.*x8 - 12.*x.*x3.*x4.*x7 + 3.*x1.*x2.*x3.*x8 + 3.*x1.*x2.*x4.*x7 + 3.*x1.*x3.*x4.*x6 - 12.*x.*x1.*x6.*x8 - 12.*x.*x2.*x6.*x7 - 12.*x.*x3.*x4.*x8 + 3.*x1.*x2.*x4.*x8 + 3.*x1.*x3.*x4.*x7 + 3.*x2.*x3.*x4.*x6 - 12.*x.*x1.*x7.*x8 - 12.*x.*x2.*x6.*x8 - 12.*x.*x3.*x6.*x7 + 3.*x1.*x2.*x6.*x7 + 3.*x1.*x3.*x4.*x8 + 3.*x2.*x3.*x4.*x7 - 12.*x.*x2.*x7.*x8 - 12.*x.*x3.*x6.*x8 - 12.*x.*x4.*x6.*x7 + 3.*x1.*x2.*x6.*x8 + 3.*x1.*x3.*x6.*x7 + 3.*x2.*x3.*x4.*x8 - 12.*x.*x3.*x7.*x8 - 12.*x.*x4.*x6.*x8 + 3.*x1.*x2.*x7.*x8 + 3.*x1.*x3.*x6.*x8 + 3.*x1.*x4.*x6.*x7 + 3.*x2.*x3.*x6.*x7 - 12.*x.*x4.*x7.*x8 + 3.*x1.*x3.*x7.*x8 + 3.*x1.*x4.*x6.*x8 + 3.*x2.*x3.*x6.*x8 + 3.*x2.*x4.*x6.*x7 + 3.*x1.*x4.*x7.*x8 + 3.*x2.*x3.*x7.*x8 + 3.*x2.*x4.*x6.*x8 + 3.*x3.*x4.*x6.*x7 - 12.*x.*x6.*x7.*x8 + 3.*x2.*x4.*x7.*x8 + 3.*x3.*x4.*x6.*x8 + 3.*x1.*x6.*x7.*x8 + 3.*x3.*x4.*x7.*x8 + 3.*x2.*x6.*x7.*x8 + 3.*x3.*x6.*x7.*x8 + 3.*x4.*x6.*x7.*x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                         -(2.*(105.*x.^4 - 60.*x.^3.*x2 - 60.*x.^3.*x3 - 60.*x.^3.*x4 - 60.*x.^3.*x5 - 60.*x.^3.*x7 - 60.*x.^3.*x8 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x2 + 30.*x.^2.*x1.*x3 + 30.*x.^2.*x1.*x4 + 30.*x.^2.*x2.*x3 + 30.*x.^2.*x1.*x5 + 30.*x.^2.*x2.*x4 + 30.*x.^2.*x2.*x5 + 30.*x.^2.*x3.*x4 + 30.*x.^2.*x1.*x7 + 30.*x.^2.*x3.*x5 + 30.*x.^2.*x1.*x8 + 30.*x.^2.*x2.*x7 + 30.*x.^2.*x4.*x5 + 30.*x.^2.*x2.*x8 + 30.*x.^2.*x3.*x7 + 30.*x.^2.*x3.*x8 + 30.*x.^2.*x4.*x7 + 30.*x.^2.*x4.*x8 + 30.*x.^2.*x5.*x7 + 30.*x.^2.*x5.*x8 + 30.*x.^2.*x7.*x8 - 12.*x.*x1.*x2.*x3 - 12.*x.*x1.*x2.*x4 - 12.*x.*x1.*x2.*x5 - 12.*x.*x1.*x3.*x4 - 12.*x.*x1.*x3.*x5 - 12.*x.*x2.*x3.*x4 - 12.*x.*x1.*x2.*x7 - 12.*x.*x1.*x4.*x5 - 12.*x.*x2.*x3.*x5 + 3.*x1.*x2.*x3.*x4 - 12.*x.*x1.*x2.*x8 - 12.*x.*x1.*x3.*x7 - 12.*x.*x2.*x4.*x5 + 3.*x1.*x2.*x3.*x5 - 12.*x.*x1.*x3.*x8 - 12.*x.*x1.*x4.*x7 - 12.*x.*x2.*x3.*x7 - 12.*x.*x3.*x4.*x5 + 3.*x1.*x2.*x4.*x5 - 12.*x.*x1.*x4.*x8 - 12.*x.*x1.*x5.*x7 - 12.*x.*x2.*x3.*x8 - 12.*x.*x2.*x4.*x7 + 3.*x1.*x2.*x3.*x7 + 3.*x1.*x3.*x4.*x5 - 12.*x.*x1.*x5.*x8 - 12.*x.*x2.*x4.*x8 - 12.*x.*x2.*x5.*x7 - 12.*x.*x3.*x4.*x7 + 3.*x1.*x2.*x3.*x8 + 3.*x1.*x2.*x4.*x7 + 3.*x2.*x3.*x4.*x5 - 12.*x.*x2.*x5.*x8 - 12.*x.*x3.*x4.*x8 - 12.*x.*x3.*x5.*x7 + 3.*x1.*x2.*x4.*x8 + 3.*x1.*x2.*x5.*x7 + 3.*x1.*x3.*x4.*x7 - 12.*x.*x1.*x7.*x8 - 12.*x.*x3.*x5.*x8 - 12.*x.*x4.*x5.*x7 + 3.*x1.*x2.*x5.*x8 + 3.*x1.*x3.*x4.*x8 + 3.*x1.*x3.*x5.*x7 + 3.*x2.*x3.*x4.*x7 - 12.*x.*x2.*x7.*x8 - 12.*x.*x4.*x5.*x8 + 3.*x1.*x3.*x5.*x8 + 3.*x1.*x4.*x5.*x7 + 3.*x2.*x3.*x4.*x8 + 3.*x2.*x3.*x5.*x7 - 12.*x.*x3.*x7.*x8 + 3.*x1.*x2.*x7.*x8 + 3.*x1.*x4.*x5.*x8 + 3.*x2.*x3.*x5.*x8 + 3.*x2.*x4.*x5.*x7 - 12.*x.*x4.*x7.*x8 + 3.*x1.*x3.*x7.*x8 + 3.*x2.*x4.*x5.*x8 + 3.*x3.*x4.*x5.*x7 - 12.*x.*x5.*x7.*x8 + 3.*x1.*x4.*x7.*x8 + 3.*x2.*x3.*x7.*x8 + 3.*x3.*x4.*x5.*x8 + 3.*x1.*x5.*x7.*x8 + 3.*x2.*x4.*x7.*x8 + 3.*x2.*x5.*x7.*x8 + 3.*x3.*x4.*x7.*x8 + 3.*x3.*x5.*x7.*x8 + 3.*x4.*x5.*x7.*x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                          (2.*(105.*x.^4 - 60.*x.^3.*x2 - 60.*x.^3.*x3 - 60.*x.^3.*x4 - 60.*x.^3.*x5 - 60.*x.^3.*x6 - 60.*x.^3.*x8 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x2 + 30.*x.^2.*x1.*x3 + 30.*x.^2.*x1.*x4 + 30.*x.^2.*x2.*x3 + 30.*x.^2.*x1.*x5 + 30.*x.^2.*x2.*x4 + 30.*x.^2.*x1.*x6 + 30.*x.^2.*x2.*x5 + 30.*x.^2.*x3.*x4 + 30.*x.^2.*x2.*x6 + 30.*x.^2.*x3.*x5 + 30.*x.^2.*x1.*x8 + 30.*x.^2.*x3.*x6 + 30.*x.^2.*x4.*x5 + 30.*x.^2.*x2.*x8 + 30.*x.^2.*x4.*x6 + 30.*x.^2.*x3.*x8 + 30.*x.^2.*x5.*x6 + 30.*x.^2.*x4.*x8 + 30.*x.^2.*x5.*x8 + 30.*x.^2.*x6.*x8 - 12.*x.*x1.*x2.*x3 - 12.*x.*x1.*x2.*x4 - 12.*x.*x1.*x2.*x5 - 12.*x.*x1.*x3.*x4 - 12.*x.*x1.*x2.*x6 - 12.*x.*x1.*x3.*x5 - 12.*x.*x2.*x3.*x4 - 12.*x.*x1.*x3.*x6 - 12.*x.*x1.*x4.*x5 - 12.*x.*x2.*x3.*x5 + 3.*x1.*x2.*x3.*x4 - 12.*x.*x1.*x2.*x8 - 12.*x.*x1.*x4.*x6 - 12.*x.*x2.*x3.*x6 - 12.*x.*x2.*x4.*x5 + 3.*x1.*x2.*x3.*x5 - 12.*x.*x1.*x3.*x8 - 12.*x.*x1.*x5.*x6 - 12.*x.*x2.*x4.*x6 - 12.*x.*x3.*x4.*x5 + 3.*x1.*x2.*x3.*x6 + 3.*x1.*x2.*x4.*x5 - 12.*x.*x1.*x4.*x8 - 12.*x.*x2.*x3.*x8 - 12.*x.*x2.*x5.*x6 - 12.*x.*x3.*x4.*x6 + 3.*x1.*x2.*x4.*x6 + 3.*x1.*x3.*x4.*x5 - 12.*x.*x1.*x5.*x8 - 12.*x.*x2.*x4.*x8 - 12.*x.*x3.*x5.*x6 + 3.*x1.*x2.*x3.*x8 + 3.*x1.*x2.*x5.*x6 + 3.*x1.*x3.*x4.*x6 + 3.*x2.*x3.*x4.*x5 - 12.*x.*x1.*x6.*x8 - 12.*x.*x2.*x5.*x8 - 12.*x.*x3.*x4.*x8 - 12.*x.*x4.*x5.*x6 + 3.*x1.*x2.*x4.*x8 + 3.*x1.*x3.*x5.*x6 + 3.*x2.*x3.*x4.*x6 - 12.*x.*x2.*x6.*x8 - 12.*x.*x3.*x5.*x8 + 3.*x1.*x2.*x5.*x8 + 3.*x1.*x3.*x4.*x8 + 3.*x1.*x4.*x5.*x6 + 3.*x2.*x3.*x5.*x6 - 12.*x.*x3.*x6.*x8 - 12.*x.*x4.*x5.*x8 + 3.*x1.*x2.*x6.*x8 + 3.*x1.*x3.*x5.*x8 + 3.*x2.*x3.*x4.*x8 + 3.*x2.*x4.*x5.*x6 - 12.*x.*x4.*x6.*x8 + 3.*x1.*x3.*x6.*x8 + 3.*x1.*x4.*x5.*x8 + 3.*x2.*x3.*x5.*x8 + 3.*x3.*x4.*x5.*x6 - 12.*x.*x5.*x6.*x8 + 3.*x1.*x4.*x6.*x8 + 3.*x2.*x3.*x6.*x8 + 3.*x2.*x4.*x5.*x8 + 3.*x1.*x5.*x6.*x8 + 3.*x2.*x4.*x6.*x8 + 3.*x3.*x4.*x5.*x8 + 3.*x2.*x5.*x6.*x8 + 3.*x3.*x4.*x6.*x8 + 3.*x3.*x5.*x6.*x8 + 3.*x4.*x5.*x6.*x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                         -(2.*(105.*x.^4 - 60.*x.^3.*x2 - 60.*x.^3.*x3 - 60.*x.^3.*x4 - 60.*x.^3.*x5 - 60.*x.^3.*x6 - 60.*x.^3.*x7 - 60.*x.^3.*x1 + 30.*x.^2.*x1.*x2 + 30.*x.^2.*x1.*x3 + 30.*x.^2.*x1.*x4 + 30.*x.^2.*x2.*x3 + 30.*x.^2.*x1.*x5 + 30.*x.^2.*x2.*x4 + 30.*x.^2.*x1.*x6 + 30.*x.^2.*x2.*x5 + 30.*x.^2.*x3.*x4 + 30.*x.^2.*x1.*x7 + 30.*x.^2.*x2.*x6 + 30.*x.^2.*x3.*x5 + 30.*x.^2.*x2.*x7 + 30.*x.^2.*x3.*x6 + 30.*x.^2.*x4.*x5 + 30.*x.^2.*x3.*x7 + 30.*x.^2.*x4.*x6 + 30.*x.^2.*x4.*x7 + 30.*x.^2.*x5.*x6 + 30.*x.^2.*x5.*x7 + 30.*x.^2.*x6.*x7 - 12.*x.*x1.*x2.*x3 - 12.*x.*x1.*x2.*x4 - 12.*x.*x1.*x2.*x5 - 12.*x.*x1.*x3.*x4 - 12.*x.*x1.*x2.*x6 - 12.*x.*x1.*x3.*x5 - 12.*x.*x2.*x3.*x4 - 12.*x.*x1.*x2.*x7 - 12.*x.*x1.*x3.*x6 - 12.*x.*x1.*x4.*x5 - 12.*x.*x2.*x3.*x5 + 3.*x1.*x2.*x3.*x4 - 12.*x.*x1.*x3.*x7 - 12.*x.*x1.*x4.*x6 - 12.*x.*x2.*x3.*x6 - 12.*x.*x2.*x4.*x5 + 3.*x1.*x2.*x3.*x5 - 12.*x.*x1.*x4.*x7 - 12.*x.*x1.*x5.*x6 - 12.*x.*x2.*x3.*x7 - 12.*x.*x2.*x4.*x6 - 12.*x.*x3.*x4.*x5 + 3.*x1.*x2.*x3.*x6 + 3.*x1.*x2.*x4.*x5 - 12.*x.*x1.*x5.*x7 - 12.*x.*x2.*x4.*x7 - 12.*x.*x2.*x5.*x6 - 12.*x.*x3.*x4.*x6 + 3.*x1.*x2.*x3.*x7 + 3.*x1.*x2.*x4.*x6 + 3.*x1.*x3.*x4.*x5 - 12.*x.*x1.*x6.*x7 - 12.*x.*x2.*x5.*x7 - 12.*x.*x3.*x4.*x7 - 12.*x.*x3.*x5.*x6 + 3.*x1.*x2.*x4.*x7 + 3.*x1.*x2.*x5.*x6 + 3.*x1.*x3.*x4.*x6 + 3.*x2.*x3.*x4.*x5 - 12.*x.*x2.*x6.*x7 - 12.*x.*x3.*x5.*x7 - 12.*x.*x4.*x5.*x6 + 3.*x1.*x2.*x5.*x7 + 3.*x1.*x3.*x4.*x7 + 3.*x1.*x3.*x5.*x6 + 3.*x2.*x3.*x4.*x6 - 12.*x.*x3.*x6.*x7 - 12.*x.*x4.*x5.*x7 + 3.*x1.*x2.*x6.*x7 + 3.*x1.*x3.*x5.*x7 + 3.*x1.*x4.*x5.*x6 + 3.*x2.*x3.*x4.*x7 + 3.*x2.*x3.*x5.*x6 - 12.*x.*x4.*x6.*x7 + 3.*x1.*x3.*x6.*x7 + 3.*x1.*x4.*x5.*x7 + 3.*x2.*x3.*x5.*x7 + 3.*x2.*x4.*x5.*x6 - 12.*x.*x5.*x6.*x7 + 3.*x1.*x4.*x6.*x7 + 3.*x2.*x3.*x6.*x7 + 3.*x2.*x4.*x5.*x7 + 3.*x3.*x4.*x5.*x6 + 3.*x1.*x5.*x6.*x7 + 3.*x2.*x4.*x6.*x7 + 3.*x3.*x4.*x5.*x7 + 3.*x2.*x5.*x6.*x7 + 3.*x3.*x4.*x6.*x7 + 3.*x3.*x5.*x6.*x7 + 3.*x4.*x5.*x6.*x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 4
                dnL=[-(2.*(180.*x.^2.*x2 + 180.*x.^2.*x3 + 180.*x.^2.*x4 + 180.*x.^2.*x5 + 180.*x.^2.*x6 + 180.*x.^2.*x7 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x2.*x3 - 60.*x.*x2.*x4 - 60.*x.*x2.*x5 - 60.*x.*x3.*x4 - 60.*x.*x2.*x6 - 60.*x.*x3.*x5 - 60.*x.*x2.*x7 - 60.*x.*x3.*x6 - 60.*x.*x4.*x5 + 12.*x2.*x3.*x4 - 60.*x.*x2.*x8 - 60.*x.*x3.*x7 - 60.*x.*x4.*x6 + 12.*x2.*x3.*x5 - 60.*x.*x3.*x8 - 60.*x.*x4.*x7 - 60.*x.*x5.*x6 + 12.*x2.*x3.*x6 + 12.*x2.*x4.*x5 - 60.*x.*x4.*x8 - 60.*x.*x5.*x7 + 12.*x2.*x3.*x7 + 12.*x2.*x4.*x6 + 12.*x3.*x4.*x5 - 60.*x.*x5.*x8 - 60.*x.*x6.*x7 + 12.*x2.*x3.*x8 + 12.*x2.*x4.*x7 + 12.*x2.*x5.*x6 + 12.*x3.*x4.*x6 - 60.*x.*x6.*x8 + 12.*x2.*x4.*x8 + 12.*x2.*x5.*x7 + 12.*x3.*x4.*x7 + 12.*x3.*x5.*x6 - 60.*x.*x7.*x8 + 12.*x2.*x5.*x8 + 12.*x2.*x6.*x7 + 12.*x3.*x4.*x8 + 12.*x3.*x5.*x7 + 12.*x4.*x5.*x6 + 12.*x2.*x6.*x8 + 12.*x3.*x5.*x8 + 12.*x3.*x6.*x7 + 12.*x4.*x5.*x7 + 12.*x2.*x7.*x8 + 12.*x3.*x6.*x8 + 12.*x4.*x5.*x8 + 12.*x4.*x6.*x7 + 12.*x3.*x7.*x8 + 12.*x4.*x6.*x8 + 12.*x5.*x6.*x7 + 12.*x4.*x7.*x8 + 12.*x5.*x6.*x8 + 12.*x5.*x7.*x8 + 12.*x6.*x7.*x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                          (2.*(180.*x.^2.*x1 + 180.*x.^2.*x3 + 180.*x.^2.*x4 + 180.*x.^2.*x5 + 180.*x.^2.*x6 + 180.*x.^2.*x7 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x1.*x3 - 60.*x.*x1.*x4 - 60.*x.*x1.*x5 - 60.*x.*x1.*x6 - 60.*x.*x3.*x4 - 60.*x.*x1.*x7 - 60.*x.*x3.*x5 + 12.*x1.*x3.*x4 - 60.*x.*x1.*x8 - 60.*x.*x3.*x6 - 60.*x.*x4.*x5 + 12.*x1.*x3.*x5 - 60.*x.*x3.*x7 - 60.*x.*x4.*x6 + 12.*x1.*x3.*x6 + 12.*x1.*x4.*x5 - 60.*x.*x3.*x8 - 60.*x.*x4.*x7 - 60.*x.*x5.*x6 + 12.*x1.*x3.*x7 + 12.*x1.*x4.*x6 - 60.*x.*x4.*x8 - 60.*x.*x5.*x7 + 12.*x1.*x3.*x8 + 12.*x1.*x4.*x7 + 12.*x1.*x5.*x6 + 12.*x3.*x4.*x5 - 60.*x.*x5.*x8 - 60.*x.*x6.*x7 + 12.*x1.*x4.*x8 + 12.*x1.*x5.*x7 + 12.*x3.*x4.*x6 - 60.*x.*x6.*x8 + 12.*x1.*x5.*x8 + 12.*x1.*x6.*x7 + 12.*x3.*x4.*x7 + 12.*x3.*x5.*x6 - 60.*x.*x7.*x8 + 12.*x1.*x6.*x8 + 12.*x3.*x4.*x8 + 12.*x3.*x5.*x7 + 12.*x4.*x5.*x6 + 12.*x1.*x7.*x8 + 12.*x3.*x5.*x8 + 12.*x3.*x6.*x7 + 12.*x4.*x5.*x7 + 12.*x3.*x6.*x8 + 12.*x4.*x5.*x8 + 12.*x4.*x6.*x7 + 12.*x3.*x7.*x8 + 12.*x4.*x6.*x8 + 12.*x5.*x6.*x7 + 12.*x4.*x7.*x8 + 12.*x5.*x6.*x8 + 12.*x5.*x7.*x8 + 12.*x6.*x7.*x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                         -(2.*(180.*x.^2.*x1 + 180.*x.^2.*x2 + 180.*x.^2.*x4 + 180.*x.^2.*x5 + 180.*x.^2.*x6 + 180.*x.^2.*x7 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x1.*x2 - 60.*x.*x1.*x4 - 60.*x.*x1.*x5 - 60.*x.*x2.*x4 - 60.*x.*x1.*x6 - 60.*x.*x2.*x5 + 12.*x1.*x2.*x4 - 60.*x.*x1.*x7 - 60.*x.*x2.*x6 + 12.*x1.*x2.*x5 - 60.*x.*x1.*x8 - 60.*x.*x2.*x7 - 60.*x.*x4.*x5 + 12.*x1.*x2.*x6 - 60.*x.*x2.*x8 - 60.*x.*x4.*x6 + 12.*x1.*x2.*x7 + 12.*x1.*x4.*x5 - 60.*x.*x4.*x7 - 60.*x.*x5.*x6 + 12.*x1.*x2.*x8 + 12.*x1.*x4.*x6 + 12.*x2.*x4.*x5 - 60.*x.*x4.*x8 - 60.*x.*x5.*x7 + 12.*x1.*x4.*x7 + 12.*x1.*x5.*x6 + 12.*x2.*x4.*x6 - 60.*x.*x5.*x8 - 60.*x.*x6.*x7 + 12.*x1.*x4.*x8 + 12.*x1.*x5.*x7 + 12.*x2.*x4.*x7 + 12.*x2.*x5.*x6 - 60.*x.*x6.*x8 + 12.*x1.*x5.*x8 + 12.*x1.*x6.*x7 + 12.*x2.*x4.*x8 + 12.*x2.*x5.*x7 - 60.*x.*x7.*x8 + 12.*x1.*x6.*x8 + 12.*x2.*x5.*x8 + 12.*x2.*x6.*x7 + 12.*x4.*x5.*x6 + 12.*x1.*x7.*x8 + 12.*x2.*x6.*x8 + 12.*x4.*x5.*x7 + 12.*x2.*x7.*x8 + 12.*x4.*x5.*x8 + 12.*x4.*x6.*x7 + 12.*x4.*x6.*x8 + 12.*x5.*x6.*x7 + 12.*x4.*x7.*x8 + 12.*x5.*x6.*x8 + 12.*x5.*x7.*x8 + 12.*x6.*x7.*x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                          (2.*(180.*x.^2.*x1 + 180.*x.^2.*x2 + 180.*x.^2.*x3 + 180.*x.^2.*x5 + 180.*x.^2.*x6 + 180.*x.^2.*x7 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x1.*x2 - 60.*x.*x1.*x3 - 60.*x.*x2.*x3 - 60.*x.*x1.*x5 + 12.*x1.*x2.*x3 - 60.*x.*x1.*x6 - 60.*x.*x2.*x5 - 60.*x.*x1.*x7 - 60.*x.*x2.*x6 - 60.*x.*x3.*x5 + 12.*x1.*x2.*x5 - 60.*x.*x1.*x8 - 60.*x.*x2.*x7 - 60.*x.*x3.*x6 + 12.*x1.*x2.*x6 + 12.*x1.*x3.*x5 - 60.*x.*x2.*x8 - 60.*x.*x3.*x7 + 12.*x1.*x2.*x7 + 12.*x1.*x3.*x6 + 12.*x2.*x3.*x5 - 60.*x.*x3.*x8 - 60.*x.*x5.*x6 + 12.*x1.*x2.*x8 + 12.*x1.*x3.*x7 + 12.*x2.*x3.*x6 - 60.*x.*x5.*x7 + 12.*x1.*x3.*x8 + 12.*x1.*x5.*x6 + 12.*x2.*x3.*x7 - 60.*x.*x5.*x8 - 60.*x.*x6.*x7 + 12.*x1.*x5.*x7 + 12.*x2.*x3.*x8 + 12.*x2.*x5.*x6 - 60.*x.*x6.*x8 + 12.*x1.*x5.*x8 + 12.*x1.*x6.*x7 + 12.*x2.*x5.*x7 + 12.*x3.*x5.*x6 - 60.*x.*x7.*x8 + 12.*x1.*x6.*x8 + 12.*x2.*x5.*x8 + 12.*x2.*x6.*x7 + 12.*x3.*x5.*x7 + 12.*x1.*x7.*x8 + 12.*x2.*x6.*x8 + 12.*x3.*x5.*x8 + 12.*x3.*x6.*x7 + 12.*x2.*x7.*x8 + 12.*x3.*x6.*x8 + 12.*x3.*x7.*x8 + 12.*x5.*x6.*x7 + 12.*x5.*x6.*x8 + 12.*x5.*x7.*x8 + 12.*x6.*x7.*x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                         -(2.*(180.*x.^2.*x1 + 180.*x.^2.*x2 + 180.*x.^2.*x3 + 180.*x.^2.*x4 + 180.*x.^2.*x6 + 180.*x.^2.*x7 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x1.*x2 - 60.*x.*x1.*x3 - 60.*x.*x1.*x4 - 60.*x.*x2.*x3 - 60.*x.*x2.*x4 + 12.*x1.*x2.*x3 - 60.*x.*x1.*x6 - 60.*x.*x3.*x4 + 12.*x1.*x2.*x4 - 60.*x.*x1.*x7 - 60.*x.*x2.*x6 + 12.*x1.*x3.*x4 - 60.*x.*x1.*x8 - 60.*x.*x2.*x7 - 60.*x.*x3.*x6 + 12.*x1.*x2.*x6 + 12.*x2.*x3.*x4 - 60.*x.*x2.*x8 - 60.*x.*x3.*x7 - 60.*x.*x4.*x6 + 12.*x1.*x2.*x7 + 12.*x1.*x3.*x6 - 60.*x.*x3.*x8 - 60.*x.*x4.*x7 + 12.*x1.*x2.*x8 + 12.*x1.*x3.*x7 + 12.*x1.*x4.*x6 + 12.*x2.*x3.*x6 - 60.*x.*x4.*x8 + 12.*x1.*x3.*x8 + 12.*x1.*x4.*x7 + 12.*x2.*x3.*x7 + 12.*x2.*x4.*x6 - 60.*x.*x6.*x7 + 12.*x1.*x4.*x8 + 12.*x2.*x3.*x8 + 12.*x2.*x4.*x7 + 12.*x3.*x4.*x6 - 60.*x.*x6.*x8 + 12.*x1.*x6.*x7 + 12.*x2.*x4.*x8 + 12.*x3.*x4.*x7 - 60.*x.*x7.*x8 + 12.*x1.*x6.*x8 + 12.*x2.*x6.*x7 + 12.*x3.*x4.*x8 + 12.*x1.*x7.*x8 + 12.*x2.*x6.*x8 + 12.*x3.*x6.*x7 + 12.*x2.*x7.*x8 + 12.*x3.*x6.*x8 + 12.*x4.*x6.*x7 + 12.*x3.*x7.*x8 + 12.*x4.*x6.*x8 + 12.*x4.*x7.*x8 + 12.*x6.*x7.*x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                          (2.*(180.*x.^2.*x1 + 180.*x.^2.*x2 + 180.*x.^2.*x3 + 180.*x.^2.*x4 + 180.*x.^2.*x5 + 180.*x.^2.*x7 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x1.*x2 - 60.*x.*x1.*x3 - 60.*x.*x1.*x4 - 60.*x.*x2.*x3 - 60.*x.*x1.*x5 - 60.*x.*x2.*x4 + 12.*x1.*x2.*x3 - 60.*x.*x2.*x5 - 60.*x.*x3.*x4 + 12.*x1.*x2.*x4 - 60.*x.*x1.*x7 - 60.*x.*x3.*x5 + 12.*x1.*x2.*x5 + 12.*x1.*x3.*x4 - 60.*x.*x1.*x8 - 60.*x.*x2.*x7 - 60.*x.*x4.*x5 + 12.*x1.*x3.*x5 + 12.*x2.*x3.*x4 - 60.*x.*x2.*x8 - 60.*x.*x3.*x7 + 12.*x1.*x2.*x7 + 12.*x1.*x4.*x5 + 12.*x2.*x3.*x5 - 60.*x.*x3.*x8 - 60.*x.*x4.*x7 + 12.*x1.*x2.*x8 + 12.*x1.*x3.*x7 + 12.*x2.*x4.*x5 - 60.*x.*x4.*x8 - 60.*x.*x5.*x7 + 12.*x1.*x3.*x8 + 12.*x1.*x4.*x7 + 12.*x2.*x3.*x7 + 12.*x3.*x4.*x5 - 60.*x.*x5.*x8 + 12.*x1.*x4.*x8 + 12.*x1.*x5.*x7 + 12.*x2.*x3.*x8 + 12.*x2.*x4.*x7 + 12.*x1.*x5.*x8 + 12.*x2.*x4.*x8 + 12.*x2.*x5.*x7 + 12.*x3.*x4.*x7 - 60.*x.*x7.*x8 + 12.*x2.*x5.*x8 + 12.*x3.*x4.*x8 + 12.*x3.*x5.*x7 + 12.*x1.*x7.*x8 + 12.*x3.*x5.*x8 + 12.*x4.*x5.*x7 + 12.*x2.*x7.*x8 + 12.*x4.*x5.*x8 + 12.*x3.*x7.*x8 + 12.*x4.*x7.*x8 + 12.*x5.*x7.*x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                         -(2.*(180.*x.^2.*x1 + 180.*x.^2.*x2 + 180.*x.^2.*x3 + 180.*x.^2.*x4 + 180.*x.^2.*x5 + 180.*x.^2.*x6 + 180.*x.^2.*x8 - 420.*x.^3 - 60.*x.*x1.*x2 - 60.*x.*x1.*x3 - 60.*x.*x1.*x4 - 60.*x.*x2.*x3 - 60.*x.*x1.*x5 - 60.*x.*x2.*x4 + 12.*x1.*x2.*x3 - 60.*x.*x1.*x6 - 60.*x.*x2.*x5 - 60.*x.*x3.*x4 + 12.*x1.*x2.*x4 - 60.*x.*x2.*x6 - 60.*x.*x3.*x5 + 12.*x1.*x2.*x5 + 12.*x1.*x3.*x4 - 60.*x.*x1.*x8 - 60.*x.*x3.*x6 - 60.*x.*x4.*x5 + 12.*x1.*x2.*x6 + 12.*x1.*x3.*x5 + 12.*x2.*x3.*x4 - 60.*x.*x2.*x8 - 60.*x.*x4.*x6 + 12.*x1.*x3.*x6 + 12.*x1.*x4.*x5 + 12.*x2.*x3.*x5 - 60.*x.*x3.*x8 - 60.*x.*x5.*x6 + 12.*x1.*x2.*x8 + 12.*x1.*x4.*x6 + 12.*x2.*x3.*x6 + 12.*x2.*x4.*x5 - 60.*x.*x4.*x8 + 12.*x1.*x3.*x8 + 12.*x1.*x5.*x6 + 12.*x2.*x4.*x6 + 12.*x3.*x4.*x5 - 60.*x.*x5.*x8 + 12.*x1.*x4.*x8 + 12.*x2.*x3.*x8 + 12.*x2.*x5.*x6 + 12.*x3.*x4.*x6 - 60.*x.*x6.*x8 + 12.*x1.*x5.*x8 + 12.*x2.*x4.*x8 + 12.*x3.*x5.*x6 + 12.*x1.*x6.*x8 + 12.*x2.*x5.*x8 + 12.*x3.*x4.*x8 + 12.*x4.*x5.*x6 + 12.*x2.*x6.*x8 + 12.*x3.*x5.*x8 + 12.*x3.*x6.*x8 + 12.*x4.*x5.*x8 + 12.*x4.*x6.*x8 + 12.*x5.*x6.*x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                          (2.*(180.*x.^2.*x1 + 180.*x.^2.*x2 + 180.*x.^2.*x3 + 180.*x.^2.*x4 + 180.*x.^2.*x5 + 180.*x.^2.*x6 + 180.*x.^2.*x7 - 420.*x.^3 - 60.*x.*x1.*x2 - 60.*x.*x1.*x3 - 60.*x.*x1.*x4 - 60.*x.*x2.*x3 - 60.*x.*x1.*x5 - 60.*x.*x2.*x4 + 12.*x1.*x2.*x3 - 60.*x.*x1.*x6 - 60.*x.*x2.*x5 - 60.*x.*x3.*x4 + 12.*x1.*x2.*x4 - 60.*x.*x1.*x7 - 60.*x.*x2.*x6 - 60.*x.*x3.*x5 + 12.*x1.*x2.*x5 + 12.*x1.*x3.*x4 - 60.*x.*x2.*x7 - 60.*x.*x3.*x6 - 60.*x.*x4.*x5 + 12.*x1.*x2.*x6 + 12.*x1.*x3.*x5 + 12.*x2.*x3.*x4 - 60.*x.*x3.*x7 - 60.*x.*x4.*x6 + 12.*x1.*x2.*x7 + 12.*x1.*x3.*x6 + 12.*x1.*x4.*x5 + 12.*x2.*x3.*x5 - 60.*x.*x4.*x7 - 60.*x.*x5.*x6 + 12.*x1.*x3.*x7 + 12.*x1.*x4.*x6 + 12.*x2.*x3.*x6 + 12.*x2.*x4.*x5 - 60.*x.*x5.*x7 + 12.*x1.*x4.*x7 + 12.*x1.*x5.*x6 + 12.*x2.*x3.*x7 + 12.*x2.*x4.*x6 + 12.*x3.*x4.*x5 - 60.*x.*x6.*x7 + 12.*x1.*x5.*x7 + 12.*x2.*x4.*x7 + 12.*x2.*x5.*x6 + 12.*x3.*x4.*x6 + 12.*x1.*x6.*x7 + 12.*x2.*x5.*x7 + 12.*x3.*x4.*x7 + 12.*x3.*x5.*x6 + 12.*x2.*x6.*x7 + 12.*x3.*x5.*x7 + 12.*x4.*x5.*x6 + 12.*x3.*x6.*x7 + 12.*x4.*x5.*x7 + 12.*x4.*x6.*x7 + 12.*x5.*x6.*x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 5
                dnL=[(2.*(60.*x2.*x3 - 360.*x.*x3 - 360.*x.*x4 - 360.*x.*x5 - 360.*x.*x2 - 360.*x.*x6 + 60.*x2.*x4 - 360.*x.*x7 + 60.*x2.*x5 + 60.*x3.*x4 - 360.*x.*x8 + 60.*x2.*x6 + 60.*x3.*x5 + 60.*x2.*x7 + 60.*x3.*x6 + 60.*x4.*x5 + 60.*x2.*x8 + 60.*x3.*x7 + 60.*x4.*x6 + 60.*x3.*x8 + 60.*x4.*x7 + 60.*x5.*x6 + 60.*x4.*x8 + 60.*x5.*x7 + 60.*x5.*x8 + 60.*x6.*x7 + 60.*x6.*x8 + 60.*x7.*x8 + 1260.*x.^2))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                         -(2.*(60.*x1.*x3 - 360.*x.*x3 - 360.*x.*x4 - 360.*x.*x1 - 360.*x.*x5 + 60.*x1.*x4 - 360.*x.*x6 + 60.*x1.*x5 - 360.*x.*x7 + 60.*x1.*x6 + 60.*x3.*x4 - 360.*x.*x8 + 60.*x1.*x7 + 60.*x3.*x5 + 60.*x1.*x8 + 60.*x3.*x6 + 60.*x4.*x5 + 60.*x3.*x7 + 60.*x4.*x6 + 60.*x3.*x8 + 60.*x4.*x7 + 60.*x5.*x6 + 60.*x4.*x8 + 60.*x5.*x7 + 60.*x5.*x8 + 60.*x6.*x7 + 60.*x6.*x8 + 60.*x7.*x8 + 1260.*x.^2))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                          (2.*(60.*x1.*x2 - 360.*x.*x2 - 360.*x.*x1 - 360.*x.*x4 - 360.*x.*x5 + 60.*x1.*x4 - 360.*x.*x6 + 60.*x1.*x5 + 60.*x2.*x4 - 360.*x.*x7 + 60.*x1.*x6 + 60.*x2.*x5 - 360.*x.*x8 + 60.*x1.*x7 + 60.*x2.*x6 + 60.*x1.*x8 + 60.*x2.*x7 + 60.*x4.*x5 + 60.*x2.*x8 + 60.*x4.*x6 + 60.*x4.*x7 + 60.*x5.*x6 + 60.*x4.*x8 + 60.*x5.*x7 + 60.*x5.*x8 + 60.*x6.*x7 + 60.*x6.*x8 + 60.*x7.*x8 + 1260.*x.^2))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                         -(2.*(60.*x1.*x2 - 360.*x.*x2 - 360.*x.*x3 - 360.*x.*x1 + 60.*x1.*x3 - 360.*x.*x5 + 60.*x2.*x3 - 360.*x.*x6 + 60.*x1.*x5 - 360.*x.*x7 + 60.*x1.*x6 + 60.*x2.*x5 - 360.*x.*x8 + 60.*x1.*x7 + 60.*x2.*x6 + 60.*x3.*x5 + 60.*x1.*x8 + 60.*x2.*x7 + 60.*x3.*x6 + 60.*x2.*x8 + 60.*x3.*x7 + 60.*x3.*x8 + 60.*x5.*x6 + 60.*x5.*x7 + 60.*x5.*x8 + 60.*x6.*x7 + 60.*x6.*x8 + 60.*x7.*x8 + 1260.*x.^2))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                          (2.*(60.*x1.*x2 - 360.*x.*x2 - 360.*x.*x3 - 360.*x.*x1 - 360.*x.*x4 + 60.*x1.*x3 + 60.*x1.*x4 + 60.*x2.*x3 - 360.*x.*x6 + 60.*x2.*x4 - 360.*x.*x7 + 60.*x1.*x6 + 60.*x3.*x4 - 360.*x.*x8 + 60.*x1.*x7 + 60.*x2.*x6 + 60.*x1.*x8 + 60.*x2.*x7 + 60.*x3.*x6 + 60.*x2.*x8 + 60.*x3.*x7 + 60.*x4.*x6 + 60.*x3.*x8 + 60.*x4.*x7 + 60.*x4.*x8 + 60.*x6.*x7 + 60.*x6.*x8 + 60.*x7.*x8 + 1260.*x.^2))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                         -(2.*(60.*x1.*x2 - 360.*x.*x2 - 360.*x.*x3 - 360.*x.*x1 - 360.*x.*x4 + 60.*x1.*x3 - 360.*x.*x5 + 60.*x1.*x4 + 60.*x2.*x3 + 60.*x1.*x5 + 60.*x2.*x4 - 360.*x.*x7 + 60.*x2.*x5 + 60.*x3.*x4 - 360.*x.*x8 + 60.*x1.*x7 + 60.*x3.*x5 + 60.*x1.*x8 + 60.*x2.*x7 + 60.*x4.*x5 + 60.*x2.*x8 + 60.*x3.*x7 + 60.*x3.*x8 + 60.*x4.*x7 + 60.*x4.*x8 + 60.*x5.*x7 + 60.*x5.*x8 + 60.*x7.*x8 + 1260.*x.^2))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                          (2.*(60.*x1.*x2 - 360.*x.*x2 - 360.*x.*x3 - 360.*x.*x1 - 360.*x.*x4 + 60.*x1.*x3 - 360.*x.*x5 + 60.*x1.*x4 + 60.*x2.*x3 - 360.*x.*x6 + 60.*x1.*x5 + 60.*x2.*x4 + 60.*x1.*x6 + 60.*x2.*x5 + 60.*x3.*x4 - 360.*x.*x8 + 60.*x2.*x6 + 60.*x3.*x5 + 60.*x1.*x8 + 60.*x3.*x6 + 60.*x4.*x5 + 60.*x2.*x8 + 60.*x4.*x6 + 60.*x3.*x8 + 60.*x5.*x6 + 60.*x4.*x8 + 60.*x5.*x8 + 60.*x6.*x8 + 1260.*x.^2))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                         -(2.*(60.*x1.*x2 - 360.*x.*x2 - 360.*x.*x3 - 360.*x.*x1 - 360.*x.*x4 + 60.*x1.*x3 - 360.*x.*x5 + 60.*x1.*x4 + 60.*x2.*x3 - 360.*x.*x6 + 60.*x1.*x5 + 60.*x2.*x4 - 360.*x.*x7 + 60.*x1.*x6 + 60.*x2.*x5 + 60.*x3.*x4 + 60.*x1.*x7 + 60.*x2.*x6 + 60.*x3.*x5 + 60.*x2.*x7 + 60.*x3.*x6 + 60.*x4.*x5 + 60.*x3.*x7 + 60.*x4.*x6 + 60.*x4.*x7 + 60.*x5.*x6 + 60.*x5.*x7 + 60.*x6.*x7 + 1260.*x.^2))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 6
                dnL=[-(2.*(360.*x2 - 2520.*x + 360.*x3 + 360.*x4 + 360.*x5 + 360.*x6 + 360.*x7 + 360.*x8))/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                          (2.*(360.*x1 - 2520.*x + 360.*x3 + 360.*x4 + 360.*x5 + 360.*x6 + 360.*x7 + 360.*x8))/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                         -(2.*(360.*x1 - 2520.*x + 360.*x2 + 360.*x4 + 360.*x5 + 360.*x6 + 360.*x7 + 360.*x8))/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                          (2.*(360.*x1 - 2520.*x + 360.*x2 + 360.*x3 + 360.*x5 + 360.*x6 + 360.*x7 + 360.*x8))/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                         -(2.*(360.*x1 - 2520.*x + 360.*x2 + 360.*x3 + 360.*x4 + 360.*x6 + 360.*x7 + 360.*x8))/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                          (2.*(360.*x1 - 2520.*x + 360.*x2 + 360.*x3 + 360.*x4 + 360.*x5 + 360.*x7 + 360.*x8))/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                         -(2.*(360.*x1 - 2520.*x + 360.*x2 + 360.*x3 + 360.*x4 + 360.*x5 + 360.*x6 + 360.*x8))/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                          (2.*(360.*x1 - 2520.*x + 360.*x2 + 360.*x3 + 360.*x4 + 360.*x5 + 360.*x6 + 360.*x7))/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
            case 7
                dnL1=[5040/((x1 - x2).*(x1 - x3).*(x1 - x4).*(x1 - x5).*(x1 - x6).*(x1 - x7).*(x1 - x8))
                         -5040/((x1 - x2).*(x2 - x3).*(x2 - x4).*(x2 - x5).*(x2 - x6).*(x2 - x7).*(x2 - x8))
                          5040/((x1 - x3).*(x2 - x3).*(x3 - x4).*(x3 - x5).*(x3 - x6).*(x3 - x7).*(x3 - x8))
                         -5040/((x1 - x4).*(x2 - x4).*(x3 - x4).*(x4 - x5).*(x4 - x6).*(x4 - x7).*(x4 - x8))
                          5040/((x1 - x5).*(x2 - x5).*(x3 - x5).*(x4 - x5).*(x5 - x6).*(x5 - x7).*(x5 - x8))
                         -5040/((x1 - x6).*(x2 - x6).*(x3 - x6).*(x4 - x6).*(x5 - x6).*(x6 - x7).*(x6 - x8))
                          5040/((x1 - x7).*(x2 - x7).*(x3 - x7).*(x4 - x7).*(x5 - x7).*(x6 - x7).*(x7 - x8))
                         -5040/((x1 - x8).*(x2 - x8).*(x3 - x8).*(x4 - x8).*(x5 - x8).*(x6 - x8).*(x7 - x8))];
                 n=8; dnL=ones(n,length(x));
                 for i=1:n
                     dnL(i,:)=dnL1(i).*dnL(i,:);
                 end
            otherwise
                dnL=zeros(8,length(x));
        end
    otherwise
        error('The maximum order of the basis is 7!');         
end


%% ! Demo
% p=3; % Order of basis
% der=0; % Order of derivatives
% n=50; % Number of nodes for plotting
% 
% x=linspace(-1, 1, n);
% knots=linspace(-1, 1, p+1);
% 
% dnL=nurlbasis(x, knots, p, der);
% 
% figure; hold on;
% plot(x, dnL); 
% plot(knots, 0*knots, 'ro');
% title('Non-uniform Langrane basis');



