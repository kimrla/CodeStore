function [x, C]=GaussLobattoQ(knots, order)
%
% Get roots and weights of Gauss-Lobatto quadrature with intervals
% 
% Calling Sequence:
% 
%   [x, C]=GaussLobattoQ(knots, order)
%
% Input : 
% 
%    knots - a vector of nodes
%
%    order - the number of integration nodes in each interval
%  
% Output :
% 
%    x - the integration node
%
%    C - the integration weights
% 
% Example: 
% 
%   knots=[-1,0,1]; order=4;
%   [x,C]=GaussLobattoQ(knots, order);
%   f=sqrt(x+1.5); ef=2.399529;
%   intf=sum(C.*f);
% 

m=length(knots); 
x=zeros(1, (m-1)*(order-1)+1); C=x;
if order<2
    error('order should >2');
elseif order<10 && order>1
    G={[-1;1], [1;1]
        [-1;0;1], [1/3;1+1/3;1/3]
        [-1;-0.447213595499958;0.447213595499958;1], [0.166666666666667;0.833333333333334;0.833333333333334;0.166666666666667]
        [-1;-0.654653670707977;0;0.654653670707977;1], [0.100000000000000;0.544444444444444;0.711111111111111;0.544444444444444;0.100000000000000]
        [-1;-0.765055323929465;-0.285231516480645;0.285231516480645;0.765055323929465;1], [0.0666666666666667;0.378474956297847;0.554858377035486;0.554858377035486;0.378474956297847;0.0666666666666667]
        [-1;-0.830223896278567;-0.468848793470714;-4.07831529249908e-56;0.468848793470714;0.830223896278567;1], [0.0476190476190476;0.276826047361566;0.431745381209863;0.487619047619048;0.431745381209863;0.276826047361566;0.0476190476190476]
        [-1;-0.871740148509607;-0.591700181433142;-0.209299217902479;0.209299217902479;0.591700181433142;0.871740148509607;1], [0.0357142857142857;0.210704227143506;0.341122692483504;0.412458794658704;0.412458794658704;0.341122692483504;0.210704227143506;0.0357142857142857]
        [-1;-0.899757995411460;-0.677186279510738;-0.363117463826178;0;0.363117463826178;0.677186279510738;0.899757995411460;1], [0.0277777777777778;0.165495361560805;0.274538712500162;0.346428510973046;0.371519274376417;0.346428510973046;0.274538712500162;0.165495361560805;0.0277777777777778]};
else
    [G{order-1, 1}, G{order-1, 2}]=GaussLobattoR(order, -1, 1);
end

for i=1:m-1
    a=knots(i); b=knots(i+1); 
    xi=(b-a)*G{order-1,1}/2+(b+a)/2; 
    Ci=(b-a)*G{order-1,2}/2; 
    t=(i-1)*(order-1); 
    x(t+1 : t+order)=xi(:)';
    C(t+1 : t+order)=C(t+1 : t+order)+Ci(:)';
end



