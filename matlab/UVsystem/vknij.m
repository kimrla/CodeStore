function vknij_x = vknij(k,n,i,j,x)
%V1N 此处显示有关此函数的摘要
%   此处显示详细说明
    vknij_x=0;
    if n==1 
        if i==1
            vknij_x=1;
        elseif i==2
            vknij_x=3^0.5*(1-2*x);
        elseif i==3
            vknij_x=5^0.5*(6*x^2-6*x+1);
        elseif i==4
            vknij_x=7^0.5*(-20*x^3+30*x^2-12*x+1);
        end
    elseif n==2
        if k==1
            if i==1
                vknij_x=3^0.5*(1-4*x)*(x>=0&x<0.5)+3^0.5*(4*x-3)*(x>=0.5&x<=1);
            elseif i==2
                vknij_x=(1-6*x)*(x>=0&x<0.5)+(5-6*x)*(x>=0.5&x<=1);
            end
        elseif k==2
            if i==1
                vknij_x=5^0.5*(16*x^2-10*x+1)*(x>=0&x<0.5)+5^0.5*(-16*x^2+22*x-7)*(x>=0.5&x<=1);
            elseif i==2
                vknij_x=3^0.5*(30*x^2-14*x+1)*(x>=0&x<0.5)+3^0.5*(30*x^2-46*x+17)*(x>=0.5&x<=1);
            elseif i==3    
                vknij_x=(40*x^2-16*x+1)*(x>=0&x<0.5)+(-40*x^2+64*x-25)*(x>=0.5&x<=1);
            end
        elseif k==3
            if i==1
                vknij_x=7^0.5*(-64*x^3+66*x^2-18*x+1)*(x>=0&x<0.5)+7^0.5*(64*x^3-126*x^2+78*x-15)*(x>=0.5&x<=1);
            elseif i==2
                vknij_x=5^0.5*(-140*x^3+114*x^2-24*x+1)*(x>=0&x<0.5)+5^0.5*(-140*x^3+306*x^2-216*x+49)*(x>=0.5&x<=1);
            elseif i==3
                vknij_x=3^0.5*(-224*x^3+156*x^2-28*x+1)*(x>=0&x<0.5)+3^0.5*(224*x^3-516*x^2+388*x-95)*(x>=0.5&x<=1);
            elseif i==4
                vknij_x=(-280*x^3+180*x^2-30*x+1)*(x>=0&x<0.5)+(-280*x^3+660*x^2-510*x+129)*(x>=0.5&x<=1);
            end
        end
    elseif n>2
        if k==1
            if i==1
        %         v1nij_x=(3*2^(n-2))^0.5*(4*j-3-2^n*x)*(x>(j-1)/(2^(n-2))&x<(2*j-1)/(2^(n-1)))+...
        %             +(3*2^(n-2))^0.5*(2^n*x-4*j+1)*(x>(2*j-1)/(2^(n-1)&x<j/(2^(n-2))));
                vknij_x=(2^(n-2))^0.5*vknij(1,2,1,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            elseif i==2
        %         v1nij_x=(2^(n-2))^0.5*(6*j-5-3*2^(n-1)*x)*(x>(j-1)/(2^(n-2))&x<(2*j-1)/(2^(n-1)))+...
        %             +(2^(n-2))^0.5*(6*j-1-3*2^(n-1)*x)*(x>(2*j-1)/(2^(n-1)&x<j/(2^(n-2))));
                vknij_x=(2^(n-2))^0.5*vknij(1,2,2,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            end
        elseif k==2
            if i==1
                vknij_x=(2^(n-2))^0.5*vknij(2,2,1,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            elseif i==2
                vknij_x=(2^(n-2))^0.5*vknij(2,2,2,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            elseif i==3
                vknij_x=(2^(n-2))^0.5*vknij(2,2,3,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            end
        elseif k==3
            if i==1
                vknij_x=(2^(n-2))^0.5*vknij(3,2,1,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            elseif i==2
                vknij_x=(2^(n-2))^0.5*vknij(3,2,2,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            elseif i==3
                vknij_x=(2^(n-2))^0.5*vknij(3,2,3,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            elseif i==4
                vknij_x=(2^(n-2))^0.5*vknij(3,2,4,1,(2^(n-2)*(x-(j-1)/(2^(n-2)))))*(x>(j-1)/(2^(n-2))&x<j/(2^(n-2)));
            end
        end
    end

    
end

